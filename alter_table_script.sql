BEGIN TRANSACTION;

--create temporary tables and drop old tables
CREATE TEMPORARY TABLE fact_metrics_temp as
select * from soa_deliver.fact_metrics;
drop table soa_deliver.fact_metrics;

CREATE TEMPORARY TABLE fact_metrics_agg_entity_temp as
select * from soa_deliver.fact_metrics_agg_entity;
drop table soa_deliver.fact_metrics_agg_entity;

CREATE TEMPORARY TABLE fact_metrics_agg_district_temp as
select * from soa_deliver.fact_metrics_agg_district;
drop table soa_deliver.fact_metrics_agg_district;

CREATE TEMPORARY TABLE fact_metrics_agg_zone_temp as
select * from soa_deliver.fact_metrics_agg_zone;
drop table soa_deliver.fact_metrics_agg_zone;

CREATE TEMPORARY TABLE fact_metrics_agg_region_temp as
select * from soa_deliver.fact_metrics_agg_region;
drop table soa_deliver.fact_metrics_agg_region;

CREATE TEMPORARY TABLE fact_metrics_agg_division_temp as
select * from soa_deliver.fact_metrics_agg_division;
drop table soa_deliver.fact_metrics_agg_division;


--create new tables
CREATE TABLE IF NOT EXISTS soa_deliver.fact_metrics
(
  cadence                                         VARCHAR(8000),
  entity                                          VARCHAR(8000),
  calendar_date                                   DATE,

  -- monthly_prerolled_12mo
  msr                                             NUMERIC,
  msr_pct                                         NUMERIC,

  -- monthly
  -- nwc_target                                      NUMERIC,
  tech_training_pct_attainment_target             NUMERIC,
  min_tr_techs                                    NUMERIC,
  nbr_fully_tr_techs                              NUMERIC,
  credit_taken                                    NUMERIC,
  credit_req                                      NUMERIC,
  saf_new_accruals                                NUMERIC,                                
  saf_new_expired                                 NUMERIC,
  saf_new_utilization                             NUMERIC,
  saf_ps_accruals                                 NUMERIC,
  saf_ps_expired                                  NUMERIC,
  saf_ps_utilization                              NUMERIC,
  saf_flex_accruals                               NUMERIC,
  saf_flex_expired                                NUMERIC,
  saf_flex_utilization                            NUMERIC,
  saf_total_accruals                              NUMERIC,
  saf_total_expired                               NUMERIC,
  saf_total_utilization                           NUMERIC,
  saf_care_connect_spend                          NUMERIC,

  -- monthly_prerolled_ytd
  profitability                                   NUMERIC,
  gp_puvr                                         NUMERIC,
  op_new_veh                                      NUMERIC,
  op_used_veh                                     NUMERIC,
  op_service                                      NUMERIC,
  op_pa_dep                                       NUMERIC,
  op_body_shop                                    NUMERIC,
  fixed_absorption                                NUMERIC,
  cust_effective_lr_subaru                        NUMERIC,
  cust_effective_lr_other                         NUMERIC,
  subaru_cust_labor_ro                            NUMERIC,
  subaru_cust_labor_sls                           NUMERIC,
  subaru_cust_labor_gp                            NUMERIC,
  subaru_cust_labor_gp_pct                        NUMERIC,
  subaru_warr_labor_ro                            NUMERIC,
  subaru_warr_labor_sls                           NUMERIC,
  subaru_warr_labor_gp                            NUMERIC,
  subaru_warr_labor_gp_pct                        NUMERIC,
  subaru_int_labor_ro                             NUMERIC,
  subaru_int_labor_sls                            NUMERIC,
  subaru_int_labor_gp                             NUMERIC,
  subaru_int_labor_gp_pct                         NUMERIC,
  subaru_prep_maint_ro                            NUMERIC,
  subaru_prep_maint_sls                           NUMERIC,
  subaru_prep_maint_gp                            NUMERIC,
  subaru_prep_maint_gp_pct                        NUMERIC,
  subaru_srv_labor_ro                             NUMERIC,
  subaru_srv_labor_sls                            NUMERIC,
  subaru_srv_labor_gp                             NUMERIC,
  subaru_srv_labor_gp_pct                         NUMERIC,
  subaru_expsrv_labor_ro                          NUMERIC,
  subaru_expsrv_labor_sls                         NUMERIC,
  subaru_expsrv_labor_gp                          NUMERIC,
  subaru_expsrv_labor_gp_pct                      NUMERIC,
  total_subaru_srv_labor_ro                       NUMERIC,
  total_subaru_srv_labor_sls                      NUMERIC,
  total_subaru_srv_labor_gp                       NUMERIC,
  total_subaru_srv_labor_gp_pct                   NUMERIC,
  subaru_parts_cust_mech_sls                      NUMERIC,
  subaru_parts_cust_mech_gp                       NUMERIC,
  subaru_parts_cust_mech_gp_pct                   NUMERIC,
  subaru_parts_cust_body_sls                      NUMERIC,
  subaru_parts_cust_body_gp                       NUMERIC,
  subaru_parts_cust_body_gp_pct                   NUMERIC,
  subaru_parts_warr_sls                           NUMERIC,
  subaru_parts_warr_gp                            NUMERIC,
  subaru_parts_warr_gp_pct                        NUMERIC,
  subaru_counter_ct                               NUMERIC,
  subaru_counter_sls                              NUMERIC,
  subaru_counter_gp                               NUMERIC,
  subaru_counter_gp_pct                           NUMERIC,
  subaru_wholesale_ct                             NUMERIC,
  subaru_wholesale_sls                            NUMERIC,
  subaru_wholesale_gp                             NUMERIC,
  subaru_wholesale_gp_pct                         NUMERIC,
  subaru_parts_prep_maint_sls                     NUMERIC,
  subaru_parts_prep_maint_gp                      NUMERIC,
  subaru_parts_prep_maint_gp_pct                  NUMERIC,
  suba_pa_sls                                     NUMERIC,
  suba_pa_gp                                      NUMERIC,
  suba_pa_gp_pct                                  NUMERIC,
  suba_pa_exp_sls                                 NUMERIC,
  suba_pa_exp_gp                                  NUMERIC,
  suba_pa_exp_gp_pct                              NUMERIC,
  tota_subaru_pa_sls                              NUMERIC,
  tota_subaru_pa_gp                               NUMERIC,
  tota_subaru_pa_gp_pct                           NUMERIC,
  labor_per_ro_subaru                             NUMERIC,
  parts_labor_sales_ratio                         NUMERIC,

  --noncompute_12mo metric
  uio_entity                                      NUMERIC,
  uio_district                                    NUMERIC,
  uio_zone                                        NUMERIC,
  uio_region                                      NUMERIC,
  uio_division                                    NUMERIC,

  --noncomputate_qtd metrics
  purchase_return_cnt_entity                      NUMERIC,
  purchase_return_cnt_district                    NUMERIC,
  purchase_return_cnt_zone                        NUMERIC,
  purchase_return_cnt_region                      NUMERIC,
  purchase_return_cnt_division                    NUMERIC,

  purchase_sat_score_entity                       NUMERIC,
  purchase_sat_score_district                     NUMERIC,
  purchase_sat_score_zone                         NUMERIC,
  purchase_sat_score_region                       NUMERIC,
  purchase_sat_score_division                     NUMERIC,

  sales_facility_score_entity                     NUMERIC,
  sales_facility_score_district                   NUMERIC,
  sales_facility_score_zone                       NUMERIC,
  sales_facility_score_region                     NUMERIC,
  sales_facility_score_division                   NUMERIC,

  sales_consultant_score_entity                   NUMERIC,
  sales_consultant_score_district                 NUMERIC,
  sales_consultant_score_zone                     NUMERIC,
  sales_consultant_score_region                   NUMERIC,
  sales_consultant_score_division                 NUMERIC,

  purchase_process_score_entity                   NUMERIC,
  purchase_process_score_district                 NUMERIC,
  purchase_process_score_zone                     NUMERIC,
  purchase_process_score_region                   NUMERIC,
  purchase_process_score_division                 NUMERIC,

  vehicle_delivery_score_entity                   NUMERIC,
  vehicle_delivery_score_district                 NUMERIC,
  vehicle_delivery_score_zone                     NUMERIC,
  vehicle_delivery_score_region                   NUMERIC,
  vehicle_delivery_score_division                 NUMERIC,

  service_return_cnt_entity                       NUMERIC,
  service_return_cnt_district                     NUMERIC,
  service_return_cnt_zone                         NUMERIC,
  service_return_cnt_region                       NUMERIC,
  service_return_cnt_division                     NUMERIC,

  service_sat_score_entity                        NUMERIC,
  service_sat_score_district                      NUMERIC,
  service_sat_score_zone                          NUMERIC,
  service_sat_score_region                        NUMERIC,
  service_sat_score_division                      NUMERIC,

  service_appt_dropoff_score_entity               NUMERIC,
  service_appt_dropoff_score_district             NUMERIC,
  service_appt_dropoff_score_zone                 NUMERIC,
  service_appt_dropoff_score_region               NUMERIC,
  service_appt_dropoff_score_division             NUMERIC,

  service_rep_score_entity                        NUMERIC,
  service_rep_score_district                      NUMERIC,
  service_rep_score_zone                          NUMERIC,
  service_rep_score_region                        NUMERIC,
  service_rep_score_division                      NUMERIC,

  service_facility_score_entity                   NUMERIC,
  service_facility_score_district                 NUMERIC,
  service_facility_score_zone                     NUMERIC,
  service_facility_score_region                   NUMERIC,
  service_facility_score_division                 NUMERIC,

  vehicle_pickup_process_score_entity             NUMERIC,
  vehicle_pickup_process_score_district           NUMERIC,
  vehicle_pickup_process_score_zone               NUMERIC,
  vehicle_pickup_process_score_region             NUMERIC,
  vehicle_pickup_process_score_division           NUMERIC,

  service_quality_score_entity                    NUMERIC,
  service_quality_score_district                  NUMERIC,
  service_quality_score_zone                      NUMERIC,
  service_quality_score_region                    NUMERIC,
  service_quality_score_division                  NUMERIC,

  frft_return_cnt_entity                          NUMERIC,
  frft_return_cnt_district                        NUMERIC,
  frft_return_cnt_zone                            NUMERIC,
  frft_return_cnt_region                          NUMERIC,
  frft_return_cnt_division                        NUMERIC,

  frft_pct_yes_score_entity                       NUMERIC,
  frft_pct_yes_score_district                     NUMERIC,
  frft_pct_yes_score_zone                         NUMERIC,
  frft_pct_yes_score_region                       NUMERIC,
  frft_pct_yes_score_division                     NUMERIC,

  frft_pct_routine_maint_yes_score_entity         NUMERIC,
  frft_pct_routine_maint_yes_score_district       NUMERIC,
  frft_pct_routine_maint_yes_score_zone           NUMERIC,
  frft_pct_routine_maint_yes_score_region         NUMERIC,
  frft_pct_routine_maint_yes_score_division       NUMERIC,

  frft_pct_warranty_yes_score_entity              NUMERIC,
  frft_pct_warranty_yes_score_district            NUMERIC,
  frft_pct_warranty_yes_score_zone                NUMERIC,
  frft_pct_warranty_yes_score_region              NUMERIC,
  frft_pct_warranty_yes_score_division            NUMERIC,

  --non_computational_mtd metrics
  part_sales_entity                               NUMERIC,
  part_sales_district                             NUMERIC,
  part_sales_zone                                 NUMERIC,
  part_sales_region                               NUMERIC,
  part_sales_division                             NUMERIC,

  part_sales_obj_entity                           NUMERIC,
  part_sales_obj_district                         NUMERIC,
  part_sales_obj_zone                             NUMERIC,
  part_sales_obj_region                           NUMERIC,
  part_sales_obj_division                         NUMERIC,

  pct_part_sales_to_obj_entity                    NUMERIC,
  pct_part_sales_to_obj_district                  NUMERIC,
  pct_part_sales_to_obj_zone                      NUMERIC,
  pct_part_sales_to_obj_region                    NUMERIC,
  pct_part_sales_to_obj_division                  NUMERIC,

  sales_rate_entity                               NUMERIC,
  sales_rate_district                             NUMERIC,
  sales_rate_zone                                 NUMERIC,
  sales_rate_region                               NUMERIC,
  sales_rate_division                             NUMERIC,

  projected_sales_entity                          NUMERIC,
  projected_sales_district                        NUMERIC,
  projected_sales_zone                            NUMERIC,
  projected_sales_region                          NUMERIC,
  projected_sales_division                        NUMERIC,

  pct_proj_vs_obj_entity                          NUMERIC,
  pct_proj_vs_obj_district                        NUMERIC,
  pct_proj_vs_obj_zone                            NUMERIC,
  pct_proj_vs_obj_region                          NUMERIC,
  pct_proj_vs_obj_division                        NUMERIC,

  port_sales_entity                               NUMERIC,
  port_sales_district                             NUMERIC,
  port_sales_zone                                 NUMERIC,
  port_sales_region                               NUMERIC,
  port_sales_division                             NUMERIC,

  port_pnvw_entity                                NUMERIC,
  port_pnvw_district                              NUMERIC,
  port_pnvw_zone                                  NUMERIC,
  port_pnvw_region                                NUMERIC,
  port_pnvw_division                              NUMERIC,

  port_obj_entity                                 NUMERIC,
  port_obj_district                               NUMERIC,
  port_obj_zone                                   NUMERIC,
  port_obj_region                                 NUMERIC,
  port_obj_division                               NUMERIC,

  port_obj_pct_entity                             NUMERIC,
  port_obj_pct_district                           NUMERIC,
  port_obj_pct_zone                               NUMERIC,
  port_obj_pct_region                             NUMERIC,
  port_obj_pct_division                           NUMERIC,

  whs_sales_entity                                NUMERIC,
  whs_sales_district                              NUMERIC,
  whs_sales_zone                                  NUMERIC,
  whs_sales_region                                NUMERIC,
  whs_sales_division                              NUMERIC,

  whs_pnvw_entity                                 NUMERIC,
  whs_pnvw_district                               NUMERIC,
  whs_pnvw_zone                                   NUMERIC,
  whs_pnvw_region                                 NUMERIC,
  whs_pnvw_division                               NUMERIC,

  whs_obj_entity                                  NUMERIC,
  whs_obj_district                                NUMERIC,
  whs_obj_zone                                    NUMERIC,
  whs_obj_region                                  NUMERIC,
  whs_obj_division                                NUMERIC,

  whs_obj_pct_entity                              NUMERIC,
  whs_obj_pct_district                            NUMERIC,
  whs_obj_pct_zone                                NUMERIC,
  whs_obj_pct_region                              NUMERIC,
  whs_obj_pct_division                            NUMERIC,

  total_sales_entity                              NUMERIC,
  total_sales_district                            NUMERIC,
  total_sales_zone                                NUMERIC,
  total_sales_region                              NUMERIC,
  total_sales_division                            NUMERIC,

  total_veh_entity                                NUMERIC,
  total_veh_district                              NUMERIC,
  total_veh_zone                                  NUMERIC,
  total_veh_region                                NUMERIC,
  total_veh_division                              NUMERIC,

  pnvw_entity                                     NUMERIC,
  pnvw_district                                   NUMERIC,
  pnvw_zone                                       NUMERIC,
  pnvw_region                                     NUMERIC,
  pnvw_division                                   NUMERIC,

  total_obj_entity                                NUMERIC,
  total_obj_district                              NUMERIC,
  total_obj_zone                                  NUMERIC,
  total_obj_region                                NUMERIC,
  total_obj_division                              NUMERIC,

  total_obj_pct_entity                            NUMERIC,
  total_obj_pct_district                          NUMERIC,
  total_obj_pct_zone                              NUMERIC,
  total_obj_pct_region                            NUMERIC,
  total_obj_pct_division                          NUMERIC,

  total_penetration_pct_entity                    NUMERIC,
  total_penetration_pct_district                  NUMERIC,
  total_penetration_pct_zone                      NUMERIC,
  total_penetration_pct_region                    NUMERIC,
  total_penetration_pct_division                  NUMERIC,

  suggested_lines_entity                          NUMERIC,
  suggested_lines_district                        NUMERIC,
  suggested_lines_zone                            NUMERIC,
  suggested_lines_region                          NUMERIC,
  suggested_lines_division                        NUMERIC,

  accepted_lines_entity                           NUMERIC,
  accepted_lines_district                         NUMERIC,
  accepted_lines_zone                             NUMERIC,
  accepted_lines_region                           NUMERIC,
  accepted_lines_division                         NUMERIC,

  line_utilization_pct_entity                     NUMERIC,
  line_utilization_pct_district                   NUMERIC,
  line_utilization_pct_zone                       NUMERIC,
  line_utilization_pct_region                     NUMERIC,
  line_utilization_pct_division                   NUMERIC,

  suggested_part_no_entity                        NUMERIC,
  suggested_part_no_district                      NUMERIC,
  suggested_part_no_zone                          NUMERIC,
  suggested_part_no_region                        NUMERIC,
  suggested_part_no_division                      NUMERIC,

  override_part_no_entity                         NUMERIC,
  override_part_no_district                       NUMERIC,
  override_part_no_zone                           NUMERIC,
  override_part_no_region                         NUMERIC,
  override_part_no_division                       NUMERIC,

  parts_accepted_pct_entity                       NUMERIC,
  parts_accepted_pct_district                     NUMERIC,
  parts_accepted_pct_zone                         NUMERIC,
  parts_accepted_pct_region                       NUMERIC,
  parts_accepted_pct_division                     NUMERIC,

  net_utilization_pct_entity                      NUMERIC,
  net_utilization_pct_district                    NUMERIC,
  net_utilization_pct_zone                        NUMERIC,
  net_utilization_pct_region                      NUMERIC,
  net_utilization_pct_division                    NUMERIC,

  total_on_hand_value_entity                      NUMERIC,
  total_on_hand_value_district                    NUMERIC,
  total_on_hand_value_zone                        NUMERIC,
  total_on_hand_value_region                      NUMERIC,
  total_on_hand_value_division                    NUMERIC,

  suggested_on_hand_value_entity                  NUMERIC,
  suggested_on_hand_value_district                NUMERIC,
  suggested_on_hand_value_zone                    NUMERIC,
  suggested_on_hand_value_region                  NUMERIC,
  suggested_on_hand_value_division                NUMERIC,

  suggested_inventory_pct_entity                  NUMERIC,
  suggested_inventory_pct_district                NUMERIC,
  suggested_inventory_pct_zone                    NUMERIC,
  suggested_inventory_pct_region                  NUMERIC,
  suggested_inventory_pct_division                NUMERIC,

  overall_performance_entity                      NUMERIC,
  overall_performance_district                    NUMERIC,
  overall_performance_zone                        NUMERIC,
  overall_performance_region                      NUMERIC,
  overall_performance_division                    NUMERIC,

  overall_rating_entity                           NUMERIC,
  overall_rating_district                         NUMERIC,
  overall_rating_zone                             NUMERIC,
  overall_rating_region                           NUMERIC,
  overall_rating_division                         NUMERIC,

  total_partseye_stock_order_value_entity         NUMERIC,
  total_partseye_stock_order_value_district       NUMERIC,
  total_partseye_stock_order_value_zone           NUMERIC,
  total_partseye_stock_order_value_region         NUMERIC,
  total_partseye_stock_order_value_division       NUMERIC,

  total_supplemental_stock_order_value_entity     NUMERIC,
  total_supplemental_stock_order_value_district   NUMERIC,
  total_supplemental_stock_order_value_zone       NUMERIC,
  total_supplemental_stock_order_value_region     NUMERIC,
  total_supplemental_stock_order_value_division   NUMERIC,

  total_emergency_order_value_entity              NUMERIC,
  total_emergency_order_value_district            NUMERIC,
  total_emergency_order_value_zone                NUMERIC,
  total_emergency_order_value_region              NUMERIC,
  total_emergency_order_value_division            NUMERIC,

  total_other_order_value_entity                  NUMERIC,
  total_other_order_value_district                NUMERIC,
  total_other_order_value_zone                    NUMERIC,
  total_other_order_value_region                  NUMERIC,
  total_other_order_value_division                NUMERIC,

  partseye_stockorder_pct_entity                  NUMERIC,
  partseye_stockorder_pct_district                NUMERIC,
  partseye_stockorder_pct_zone                    NUMERIC,
  partseye_stockorder_pct_region                  NUMERIC,
  partseye_stockorder_pct_division                NUMERIC,

  mechanical_off_shelf_fill_rate_entity           NUMERIC,
  mechanical_off_shelf_fill_rate_district         NUMERIC,
  mechanical_off_shelf_fill_rate_zone             NUMERIC,
  mechanical_off_shelf_fill_rate_region           NUMERIC,
  mechanical_off_shelf_fill_rate_division         NUMERIC,

  mechanical_pieces_sold_entity                   NUMERIC,
  mechanical_pieces_sold_district                 NUMERIC,
  mechanical_pieces_sold_zone                     NUMERIC,
  mechanical_pieces_sold_region                   NUMERIC,
  mechanical_pieces_sold_division                 NUMERIC,

  mechanical_pieces_sold_from_shelf_entity        NUMERIC,
  mechanical_pieces_sold_from_shelf_district      NUMERIC,
  mechanical_pieces_sold_from_shelf_zone          NUMERIC,
  mechanical_pieces_sold_from_shelf_region        NUMERIC,
  mechanical_pieces_sold_from_shelf_division      NUMERIC,

  mechanical_emergency_orders_entity              NUMERIC,
  mechanical_emergency_orders_district            NUMERIC,
  mechanical_emergency_orders_zone                NUMERIC,
  mechanical_emergency_orders_region              NUMERIC,
  mechanical_emergency_orders_division            NUMERIC,

  mechanical_lost_sales_entity                    NUMERIC,
  mechanical_lost_sales_district                  NUMERIC,
  mechanical_lost_sales_zone                      NUMERIC,
  mechanical_lost_sales_region                    NUMERIC,
  mechanical_lost_sales_division                  NUMERIC,

  net_off_shelf_fill_rate_pct_entity              NUMERIC,
  net_off_shelf_fill_rate_pct_district            NUMERIC,
  net_off_shelf_fill_rate_pct_zone                NUMERIC,
  net_off_shelf_fill_rate_pct_region              NUMERIC,
  net_off_shelf_fill_rate_pct_division            NUMERIC,

  total_off_shelf_fill_rate_entity                NUMERIC,
  total_off_shelf_fill_rate_district              NUMERIC,
  total_off_shelf_fill_rate_zone                  NUMERIC,
  total_off_shelf_fill_rate_region                NUMERIC,
  total_off_shelf_fill_rate_division              NUMERIC,

  lost_sales_part_pct_entity                      NUMERIC,
  lost_sales_part_pct_district                    NUMERIC,
  lost_sales_part_pct_zone                        NUMERIC,
  lost_sales_part_pct_region                      NUMERIC,
  lost_sales_part_pct_division                    NUMERIC,

  lost_sales_total_entity                         NUMERIC,
  lost_sales_total_district                       NUMERIC,
  lost_sales_total_zone                           NUMERIC,
  lost_sales_total_region                         NUMERIC,
  lost_sales_total_division                       NUMERIC,

  total_demand_entity                             NUMERIC,
  total_demand_district                           NUMERIC,
  total_demand_zone                               NUMERIC,
  total_demand_region                             NUMERIC,
  total_demand_division                           NUMERIC,

  total_demand_per_employee_3_entity              NUMERIC,
  total_demand_per_employee_3_district            NUMERIC,
  total_demand_per_employee_3_zone                NUMERIC,
  total_demand_per_employee_3_region              NUMERIC,
  total_demand_per_employee_3_division            NUMERIC,

  total_suggestible_demand_entity                 NUMERIC,
  total_suggestible_demand_district               NUMERIC,
  total_suggestible_demand_zone                   NUMERIC,
  total_suggestible_demand_region                 NUMERIC,
  total_suggestible_demand_division               NUMERIC,

  vehicle_sales_entity                            NUMERIC,
  vehicle_sales_district                          NUMERIC,
  vehicle_sales_zone                              NUMERIC,
  vehicle_sales_region                            NUMERIC,
  vehicle_sales_division                          NUMERIC,

  mechanical_sales_entity                         NUMERIC,
  mechanical_sales_district                       NUMERIC,
  mechanical_sales_zone                           NUMERIC,
  mechanical_sales_region                         NUMERIC,
  mechanical_sales_division                       NUMERIC,

  maintenance_sales_entity                        NUMERIC,
  maintenance_sales_district                      NUMERIC,
  maintenance_sales_zone                          NUMERIC,
  maintenance_sales_region                        NUMERIC,
  maintenance_sales_division                      NUMERIC,

  cpo_sales_entity                                NUMERIC,
  cpo_sales_district                              NUMERIC,
  cpo_sales_zone                                  NUMERIC,
  cpo_sales_region                                NUMERIC,
  cpo_sales_division                              NUMERIC,

  total_sales_security_entity                     NUMERIC,
  total_sales_security_district                   NUMERIC,
  total_sales_security_zone                       NUMERIC,
  total_sales_security_region                     NUMERIC,
  total_sales_security_division                   NUMERIC,

  mechanical_penetration_pct_entity               NUMERIC,
  mechanical_penetration_pct_district             NUMERIC,
  mechanical_penetration_pct_zone                 NUMERIC,
  mechanical_penetration_pct_region               NUMERIC,
  mechanical_penetration_pct_division             NUMERIC,

  maintenance_penetration_pct_entity              NUMERIC,
  maintenance_penetration_pct_district            NUMERIC,
  maintenance_penetration_pct_zone                NUMERIC,
  maintenance_penetration_pct_region              NUMERIC,
  maintenance_penetration_pct_division            NUMERIC,

  cpo_penetration_pct_entity                      NUMERIC,
  cpo_penetration_pct_district                    NUMERIC,
  cpo_penetration_pct_zone                        NUMERIC,
  cpo_penetration_pct_region                      NUMERIC,
  cpo_penetration_pct_division                    NUMERIC,

  mech_cpo_pen_pct_entity                         NUMERIC,
  mech_cpo_pen_pct_district                       NUMERIC,
  mech_cpo_pen_pct_zone                           NUMERIC,
  mech_cpo_pen_pct_region                         NUMERIC,
  mech_cpo_pen_pct_division                       NUMERIC,

  mech_cpo_pen_pct_obj_entity                     NUMERIC,
  mech_cpo_pen_pct_obj_district                   NUMERIC,
  mech_cpo_pen_pct_obj_zone                       NUMERIC,
  mech_cpo_pen_pct_obj_region                     NUMERIC,
  mech_cpo_pen_pct_obj_division                   NUMERIC,

  msr_last_update                                 DATE,
  msr_pct_last_update                             DATE,
  uio_last_update                                 DATE,
  nwc_target_last_update                          DATE,
  tech_training_pct_attainment_target_last_update DATE,
  fully_trained_techs_req_last_update             DATE,
  fully_trained_techs_last_update                 DATE,
  tech_training_credit_taken_last_update          DATE,
  tech_training_credit_req_last_update            DATE,
  purchase_return_cnt_last_update                 DATE,
  purchase_sat_score_last_update                  DATE,
  sales_facility_score_last_update                DATE,
  sales_consultant_score_last_update              DATE,
  purchase_process_score_last_update              DATE,
  vehicle_delivery_score_last_update              DATE,
  service_return_cnt_last_update                  DATE,
  service_sat_score_last_update                   DATE,
  service_appt_dropoff_score_last_update          DATE,
  service_rep_score_last_update                   DATE,
  service_facility_score_last_update              DATE,
  vehicle_pickup_process_score_last_update        DATE,
  service_quality_score_last_update               DATE,
  frft_return_cnt_last_update                     DATE,
  frft_pct_yes_score_last_update                  DATE,
  frft_pct_routine_maint_yes_score_last_update    DATE,
  frft_pct_warranty_yes_score_last_update         DATE,
  part_sales_last_update                          DATE,
  part_sales_obj_last_update                      DATE,
  pct_part_sales_to_obj_last_update               DATE,
  sales_rate_last_update                          DATE,
  projected_sales_last_update                     DATE,
  pct_proj_vs_obj_last_update                     DATE,

  port_sales_last_update                          DATE,
  port_pnvw_last_update                           DATE,
  port_obj_last_update                            DATE,
  port_obj_pct_last_update                        DATE,
  whs_sales_last_update                           DATE,
  whs_pnvw_last_update                            DATE,
  whs_obj_last_update                             DATE,
  whs_obj_pct_last_update                         DATE,
  total_sales_last_update                         DATE,
  total_veh_last_update                           DATE,
  pnvw_last_update                                DATE,
  total_obj_last_update                           DATE,
  total_obj_pct_last_update                       DATE
);


CREATE TABLE IF NOT EXISTS soa_deliver.fact_metrics_agg_entity
(
  entity                              VARCHAR(8000),
  entity_path                         VARCHAR(8000),
  cadence                             VARCHAR(8000),
  compute_period                      VARCHAR(8000),
  period_type                         VARCHAR(8000),
  to_period                           DATE,

  msr                                 NUMERIC,
  msr_pct                             NUMERIC,
  uio                                 NUMERIC,

  -- nwc_target                          NUMERIC,

  tech_training_pct_attainment_target NUMERIC,
  fully_trained_techs_req             NUMERIC,
  fully_trained_techs                 NUMERIC,
  tech_training_credit_taken          NUMERIC,
  tech_training_credit_req            NUMERIC,
  tech_training_pct_attainment        NUMERIC,
  saf_new_accruals                    NUMERIC,                                
  saf_new_expired                     NUMERIC,
  saf_new_utilization                 NUMERIC,
  saf_ps_accruals                     NUMERIC,
  saf_ps_expired                      NUMERIC,
  saf_ps_utilization                  NUMERIC,
  saf_flex_accruals                   NUMERIC,
  saf_flex_expired                    NUMERIC,
  saf_flex_utilization                NUMERIC,
  saf_total_accruals                  NUMERIC,
  saf_total_expired                   NUMERIC,
  saf_total_utilization               NUMERIC,
  saf_care_connect_spend              NUMERIC,

  profitability                       NUMERIC,

  purchase_return_cnt                 NUMERIC,
  purchase_sat_score                  NUMERIC,
  sales_facility_score                NUMERIC,
  sales_consultant_score              NUMERIC,
  purchase_process_score              NUMERIC,
  vehicle_delivery_score              NUMERIC,
  service_return_cnt                  NUMERIC,
  service_sat_score                   NUMERIC,
  service_appt_dropoff_score          NUMERIC,
  service_rep_score                   NUMERIC,
  service_facility_score              NUMERIC,
  vehicle_pickup_process_score        NUMERIC,
  service_quality_score               NUMERIC,
  frft_return_cnt                     NUMERIC,
  frft_pct_yes_score                  NUMERIC,
  frft_pct_routine_maint_yes_score    NUMERIC,
  frft_pct_warranty_yes_score         NUMERIC,

  part_sales                          NUMERIC,
  part_sales_obj                      NUMERIC,
  pct_part_sales_to_obj               NUMERIC,
  sales_rate                          NUMERIC,
  projected_sales                     NUMERIC,
  pct_proj_vs_obj                     NUMERIC,
  port_sales                          NUMERIC,
  port_pnvw                           NUMERIC,
  port_obj                            NUMERIC,
  port_obj_pct                        NUMERIC,
  whs_sales                           NUMERIC,
  whs_pnvw                            NUMERIC,
  whs_obj                             NUMERIC,
  whs_obj_pct                         NUMERIC,
  total_sales                         NUMERIC,
  total_veh                           NUMERIC,
  pnvw                                NUMERIC,
  total_obj                           NUMERIC,
  total_obj_pct                       NUMERIC,
  total_penetration_pct               NUMERIC,
  
  suggested_lines                      NUMERIC,
  accepted_lines                       NUMERIC,
  line_utilization_pct                 NUMERIC,
  suggested_part_no                    NUMERIC,
  override_part_no                     NUMERIC,
  parts_accepted_pct                   NUMERIC,
  net_utilization_pct                  NUMERIC,
  total_on_hand_value                  NUMERIC,
  suggested_on_hand_value              NUMERIC,
  suggested_inventory_pct              NUMERIC,
  overall_performance                  NUMERIC,
  overall_rating                       NUMERIC,
  total_partseye_stock_order_value     NUMERIC,
  total_supplemental_stock_order_value NUMERIC,
  total_emergency_order_value          NUMERIC,
  total_other_order_value              NUMERIC,
  partseye_stockorder_pct              NUMERIC,
  mechanical_off_shelf_fill_rate       NUMERIC,
  mechanical_pieces_sold               NUMERIC,
  mechanical_pieces_sold_from_shelf    NUMERIC,
  mechanical_emergency_orders          NUMERIC,
  mechanical_lost_sales                NUMERIC,
  net_off_shelf_fill_rate_pct          NUMERIC,
  total_off_shelf_fill_rate            NUMERIC,
  lost_sales_part_pct                  NUMERIC,
  lost_sales_total                     NUMERIC,
  total_demand                         NUMERIC,
  total_demand_per_employee_3          NUMERIC,
  total_suggestible_demand             NUMERIC,
  vehicle_sales                       NUMERIC,
  mechanical_sales                    NUMERIC,
  maintenance_sales                   NUMERIC,
  cpo_sales                           NUMERIC,
  total_sales_security                NUMERIC,
  mechanical_penetration_pct          NUMERIC,
  maintenance_penetration_pct         NUMERIC,
  cpo_penetration_pct                 NUMERIC,
  mech_cpo_pen_pct                    NUMERIC,
  mech_cpo_pen_pct_obj                NUMERIC,
  gp_puvr                             NUMERIC,
  op_new_veh                          NUMERIC,
  op_used_veh                         NUMERIC,
  op_service                          NUMERIC,
  op_pa_dep                           NUMERIC,
  op_body_shop                        NUMERIC,
  fixed_absorption                    NUMERIC,
  cust_effective_lr_subaru            NUMERIC,
  cust_effective_lr_other             NUMERIC,
  subaru_cust_labor_ro                NUMERIC,
  subaru_cust_labor_sls               NUMERIC,
  subaru_cust_labor_gp                NUMERIC,
  subaru_cust_labor_gp_pct            NUMERIC,
  subaru_warr_labor_ro                NUMERIC,
  subaru_warr_labor_sls               NUMERIC,
  subaru_warr_labor_gp                NUMERIC,
  subaru_warr_labor_gp_pct            NUMERIC,
  subaru_int_labor_ro                 NUMERIC,
  subaru_int_labor_sls                NUMERIC,
  subaru_int_labor_gp                 NUMERIC,
  subaru_int_labor_gp_pct             NUMERIC,
  subaru_prep_maint_ro                NUMERIC,
  subaru_prep_maint_sls               NUMERIC,
  subaru_prep_maint_gp                NUMERIC,
  subaru_prep_maint_gp_pct            NUMERIC,
  subaru_srv_labor_ro                 NUMERIC,
  subaru_srv_labor_sls                NUMERIC,
  subaru_srv_labor_gp                 NUMERIC,
  subaru_srv_labor_gp_pct             NUMERIC,
  subaru_expsrv_labor_ro              NUMERIC,
  subaru_expsrv_labor_sls             NUMERIC,
  subaru_expsrv_labor_gp              NUMERIC,
  subaru_expsrv_labor_gp_pct          NUMERIC,
  total_subaru_srv_labor_ro           NUMERIC,
  total_subaru_srv_labor_sls          NUMERIC,
  total_subaru_srv_labor_gp           NUMERIC,
  total_subaru_srv_labor_gp_pct       NUMERIC,
  subaru_parts_cust_mech_sls          NUMERIC,
  subaru_parts_cust_mech_gp           NUMERIC,
  subaru_parts_cust_mech_gp_pct       NUMERIC,
  subaru_parts_cust_body_sls          NUMERIC,
  subaru_parts_cust_body_gp           NUMERIC,
  subaru_parts_cust_body_gp_pct       NUMERIC,
  subaru_parts_warr_sls               NUMERIC,
  subaru_parts_warr_gp                NUMERIC,
  subaru_parts_warr_gp_pct            NUMERIC,
  subaru_counter_ct                   NUMERIC,
  subaru_counter_sls                  NUMERIC,
  subaru_counter_gp                   NUMERIC,
  subaru_counter_gp_pct               NUMERIC,
  subaru_wholesale_ct                 NUMERIC,
  subaru_wholesale_sls                NUMERIC,
  subaru_wholesale_gp                 NUMERIC,
  subaru_wholesale_gp_pct             NUMERIC,
  subaru_parts_prep_maint_sls         NUMERIC,
  subaru_parts_prep_maint_gp          NUMERIC,
  subaru_parts_prep_maint_gp_pct      NUMERIC,
  suba_pa_sls                         NUMERIC,
  suba_pa_gp                          NUMERIC,
  suba_pa_gp_pct                      NUMERIC,
  suba_pa_exp_sls                     NUMERIC,
  suba_pa_exp_gp                      NUMERIC,
  suba_pa_exp_gp_pct                  NUMERIC,
  tota_subaru_pa_sls                  NUMERIC,
  tota_subaru_pa_gp                   NUMERIC,
  tota_subaru_pa_gp_pct               NUMERIC,
  labor_per_ro_subaru                 NUMERIC,
  parts_labor_sales_ratio             NUMERIC
);

CREATE TABLE IF NOT EXISTS soa_deliver.fact_metrics_agg_district
(
  district                             VARCHAR(8000),
  district_path                        VARCHAR(8000),
  cadence                              VARCHAR(8000),
  compute_period                       VARCHAR(8000),
  period_type                          VARCHAR(8000),
  to_period                            DATE,

  msr                                 NUMERIC,
  msr_pct                             NUMERIC,
  uio                                 NUMERIC,

  -- nwc_target                          NUMERIC,

  tech_training_pct_attainment_target NUMERIC,
  fully_trained_techs_req             NUMERIC,
  fully_trained_techs                 NUMERIC,
  tech_training_credit_taken          NUMERIC,
  tech_training_credit_req            NUMERIC,
  tech_training_pct_attainment        NUMERIC,
  saf_new_accruals                    NUMERIC,                                
  saf_new_expired                     NUMERIC,
  saf_new_utilization                 NUMERIC,
  saf_ps_accruals                     NUMERIC,
  saf_ps_expired                      NUMERIC,
  saf_ps_utilization                  NUMERIC,
  saf_flex_accruals                   NUMERIC,
  saf_flex_expired                    NUMERIC,
  saf_flex_utilization                NUMERIC,
  saf_total_accruals                  NUMERIC,
  saf_total_expired                   NUMERIC,
  saf_total_utilization               NUMERIC,
  saf_care_connect_spend              NUMERIC,
  profitability                       NUMERIC,

  purchase_return_cnt                 NUMERIC,
  purchase_sat_score                  NUMERIC,
  sales_facility_score                NUMERIC,
  sales_consultant_score              NUMERIC,
  purchase_process_score              NUMERIC,
  vehicle_delivery_score              NUMERIC,
  service_return_cnt                  NUMERIC,
  service_sat_score                   NUMERIC,
  service_appt_dropoff_score          NUMERIC,
  service_rep_score                   NUMERIC,
  service_facility_score              NUMERIC,
  vehicle_pickup_process_score        NUMERIC,
  service_quality_score               NUMERIC,
  frft_return_cnt                     NUMERIC,
  frft_pct_yes_score                  NUMERIC,
  frft_pct_routine_maint_yes_score    NUMERIC,
  frft_pct_warranty_yes_score         NUMERIC,

  part_sales                          NUMERIC,
  part_sales_obj                      NUMERIC,
  pct_part_sales_to_obj               NUMERIC,
  sales_rate                          NUMERIC,
  projected_sales                     NUMERIC,
  pct_proj_vs_obj                     NUMERIC,
  port_sales                          NUMERIC,
  port_pnvw                           NUMERIC,
  port_obj                            NUMERIC,
  port_obj_pct                        NUMERIC,
  whs_sales                           NUMERIC,
  whs_pnvw                            NUMERIC,
  whs_obj                             NUMERIC,
  whs_obj_pct                         NUMERIC,
  total_sales                         NUMERIC,
  total_veh                           NUMERIC,
  pnvw                                NUMERIC,
  total_obj                           NUMERIC,
  total_obj_pct                       NUMERIC,
  total_penetration_pct               NUMERIC,
  
  suggested_lines                      NUMERIC,
  accepted_lines                       NUMERIC,
  line_utilization_pct                 NUMERIC,
  suggested_part_no                    NUMERIC,
  override_part_no                     NUMERIC,
  parts_accepted_pct                   NUMERIC,
  net_utilization_pct                  NUMERIC,
  total_on_hand_value                  NUMERIC,
  suggested_on_hand_value              NUMERIC,
  suggested_inventory_pct              NUMERIC,
  overall_performance                  NUMERIC,
  overall_rating                       NUMERIC,
  total_partseye_stock_order_value     NUMERIC,
  total_supplemental_stock_order_value NUMERIC,
  total_emergency_order_value          NUMERIC,
  total_other_order_value              NUMERIC,
  partseye_stockorder_pct              NUMERIC,
  mechanical_off_shelf_fill_rate       NUMERIC,
  mechanical_pieces_sold               NUMERIC,
  mechanical_pieces_sold_from_shelf    NUMERIC,
  mechanical_emergency_orders          NUMERIC,
  mechanical_lost_sales                NUMERIC,
  net_off_shelf_fill_rate_pct          NUMERIC,
  total_off_shelf_fill_rate            NUMERIC,
  lost_sales_part_pct                  NUMERIC,
  lost_sales_total                     NUMERIC,
  total_demand                         NUMERIC,
  total_demand_per_employee_3          NUMERIC,
  total_suggestible_demand             NUMERIC,
  vehicle_sales                       NUMERIC,
  mechanical_sales                    NUMERIC,
  maintenance_sales                   NUMERIC,
  cpo_sales                           NUMERIC,
  total_sales_security                NUMERIC,
  mechanical_penetration_pct          NUMERIC,
  maintenance_penetration_pct         NUMERIC,
  cpo_penetration_pct                 NUMERIC,
  mech_cpo_pen_pct                    NUMERIC,
  mech_cpo_pen_pct_obj                NUMERIC,
  gp_puvr                             NUMERIC,
  op_new_veh                          NUMERIC,
  op_used_veh                         NUMERIC,
  op_service                          NUMERIC,
  op_pa_dep                           NUMERIC,
  op_body_shop                        NUMERIC,
  fixed_absorption                    NUMERIC,
  cust_effective_lr_subaru            NUMERIC,
  cust_effective_lr_other             NUMERIC,
  subaru_cust_labor_ro                NUMERIC,
  subaru_cust_labor_sls               NUMERIC,
  subaru_cust_labor_gp                NUMERIC,
  subaru_cust_labor_gp_pct            NUMERIC,
  subaru_warr_labor_ro                NUMERIC,
  subaru_warr_labor_sls               NUMERIC,
  subaru_warr_labor_gp                NUMERIC,
  subaru_warr_labor_gp_pct            NUMERIC,
  subaru_int_labor_ro                 NUMERIC,
  subaru_int_labor_sls                NUMERIC,
  subaru_int_labor_gp                 NUMERIC,
  subaru_int_labor_gp_pct             NUMERIC,
  subaru_prep_maint_ro                NUMERIC,
  subaru_prep_maint_sls               NUMERIC,
  subaru_prep_maint_gp                NUMERIC,
  subaru_prep_maint_gp_pct            NUMERIC,
  subaru_srv_labor_ro                 NUMERIC,
  subaru_srv_labor_sls                NUMERIC,
  subaru_srv_labor_gp                 NUMERIC,
  subaru_srv_labor_gp_pct             NUMERIC,
  subaru_expsrv_labor_ro              NUMERIC,
  subaru_expsrv_labor_sls             NUMERIC,
  subaru_expsrv_labor_gp              NUMERIC,
  subaru_expsrv_labor_gp_pct          NUMERIC,
  total_subaru_srv_labor_ro           NUMERIC,
  total_subaru_srv_labor_sls          NUMERIC,
  total_subaru_srv_labor_gp           NUMERIC,
  total_subaru_srv_labor_gp_pct       NUMERIC,
  subaru_parts_cust_mech_sls          NUMERIC,
  subaru_parts_cust_mech_gp           NUMERIC,
  subaru_parts_cust_mech_gp_pct       NUMERIC,
  subaru_parts_cust_body_sls          NUMERIC,
  subaru_parts_cust_body_gp           NUMERIC,
  subaru_parts_cust_body_gp_pct       NUMERIC,
  subaru_parts_warr_sls               NUMERIC,
  subaru_parts_warr_gp                NUMERIC,
  subaru_parts_warr_gp_pct            NUMERIC,
  subaru_counter_ct                   NUMERIC,
  subaru_counter_sls                  NUMERIC,
  subaru_counter_gp                   NUMERIC,
  subaru_counter_gp_pct               NUMERIC,
  subaru_wholesale_ct                 NUMERIC,
  subaru_wholesale_sls                NUMERIC,
  subaru_wholesale_gp                 NUMERIC,
  subaru_wholesale_gp_pct             NUMERIC,
  subaru_parts_prep_maint_sls         NUMERIC,
  subaru_parts_prep_maint_gp          NUMERIC,
  subaru_parts_prep_maint_gp_pct      NUMERIC,
  suba_pa_sls                         NUMERIC,
  suba_pa_gp                          NUMERIC,
  suba_pa_gp_pct                      NUMERIC,
  suba_pa_exp_sls                     NUMERIC,
  suba_pa_exp_gp                      NUMERIC,
  suba_pa_exp_gp_pct                  NUMERIC,
  tota_subaru_pa_sls                  NUMERIC,
  tota_subaru_pa_gp                   NUMERIC,
  tota_subaru_pa_gp_pct               NUMERIC,
  labor_per_ro_subaru                 NUMERIC,
  parts_labor_sales_ratio             NUMERIC
);


CREATE TABLE IF NOT EXISTS soa_deliver.fact_metrics_agg_zone
(
  zone                                VARCHAR(8000),
  zone_path                           VARCHAR(8000),
  cadence                             VARCHAR(8000),
  compute_period                      VARCHAR(8000),
  period_type                         VARCHAR(8000),
  to_period                           DATE,

  msr                                 NUMERIC,
  msr_pct                             NUMERIC,
  uio                                 NUMERIC,

  -- nwc_target                          NUMERIC,

  tech_training_pct_attainment_target NUMERIC,
  fully_trained_techs_req             NUMERIC,
  fully_trained_techs                 NUMERIC,
  tech_training_credit_taken          NUMERIC,
  tech_training_credit_req            NUMERIC,
  tech_training_pct_attainment        NUMERIC,
  saf_new_accruals                    NUMERIC,                                
  saf_new_expired                     NUMERIC,
  saf_new_utilization                 NUMERIC,
  saf_ps_accruals                     NUMERIC,
  saf_ps_expired                      NUMERIC,
  saf_ps_utilization                  NUMERIC,
  saf_flex_accruals                   NUMERIC,
  saf_flex_expired                    NUMERIC,
  saf_flex_utilization                NUMERIC,
  saf_total_accruals                  NUMERIC,
  saf_total_expired                   NUMERIC,
  saf_total_utilization               NUMERIC,
  saf_care_connect_spend              NUMERIC,
  profitability                       NUMERIC,

  purchase_return_cnt                 NUMERIC,
  purchase_sat_score                  NUMERIC,
  sales_facility_score                NUMERIC,
  sales_consultant_score              NUMERIC,
  purchase_process_score              NUMERIC,
  vehicle_delivery_score              NUMERIC,
  service_return_cnt                  NUMERIC,
  service_sat_score                   NUMERIC,
  service_appt_dropoff_score          NUMERIC,
  service_rep_score                   NUMERIC,
  service_facility_score              NUMERIC,
  vehicle_pickup_process_score        NUMERIC,
  service_quality_score               NUMERIC,
  frft_return_cnt                     NUMERIC,
  frft_pct_yes_score                  NUMERIC,
  frft_pct_routine_maint_yes_score    NUMERIC,
  frft_pct_warranty_yes_score         NUMERIC,

  part_sales                          NUMERIC,
  part_sales_obj                      NUMERIC,
  pct_part_sales_to_obj               NUMERIC,
  sales_rate                          NUMERIC,
  projected_sales                     NUMERIC,
  pct_proj_vs_obj                     NUMERIC,
  port_sales                          NUMERIC,
  port_pnvw                           NUMERIC,
  port_obj                            NUMERIC,
  port_obj_pct                        NUMERIC,
  whs_sales                           NUMERIC,
  whs_pnvw                            NUMERIC,
  whs_obj                             NUMERIC,
  whs_obj_pct                         NUMERIC,
  total_sales                         NUMERIC,
  total_veh                           NUMERIC,
  pnvw                                NUMERIC,
  total_obj                           NUMERIC,
  total_obj_pct                       NUMERIC,
  total_penetration_pct               NUMERIC,
  
  suggested_lines                      NUMERIC,
  accepted_lines                       NUMERIC,
  line_utilization_pct                 NUMERIC,
  suggested_part_no                    NUMERIC,
  override_part_no                     NUMERIC,
  parts_accepted_pct                   NUMERIC,
  net_utilization_pct                  NUMERIC,
  total_on_hand_value                  NUMERIC,
  suggested_on_hand_value              NUMERIC,
  suggested_inventory_pct              NUMERIC,
  overall_performance                  NUMERIC,
  overall_rating                       NUMERIC,
  total_partseye_stock_order_value     NUMERIC,
  total_supplemental_stock_order_value NUMERIC,
  total_emergency_order_value          NUMERIC,
  total_other_order_value              NUMERIC,
  partseye_stockorder_pct              NUMERIC,
  mechanical_off_shelf_fill_rate       NUMERIC,
  mechanical_pieces_sold               NUMERIC,
  mechanical_pieces_sold_from_shelf    NUMERIC,
  mechanical_emergency_orders          NUMERIC,
  mechanical_lost_sales                NUMERIC,
  net_off_shelf_fill_rate_pct          NUMERIC,
  total_off_shelf_fill_rate            NUMERIC,
  lost_sales_part_pct                  NUMERIC,
  lost_sales_total                     NUMERIC,
  total_demand                         NUMERIC,
  total_demand_per_employee_3          NUMERIC,
  total_suggestible_demand             NUMERIC,
  vehicle_sales                       NUMERIC,
  mechanical_sales                    NUMERIC,
  maintenance_sales                   NUMERIC,
  cpo_sales                           NUMERIC,
  total_sales_security                NUMERIC,
  mechanical_penetration_pct          NUMERIC,
  maintenance_penetration_pct         NUMERIC,
  cpo_penetration_pct                 NUMERIC,
  mech_cpo_pen_pct                    NUMERIC,
  mech_cpo_pen_pct_obj                NUMERIC,
  gp_puvr                             NUMERIC,
  op_new_veh                          NUMERIC,
  op_used_veh                         NUMERIC,
  op_service                          NUMERIC,
  op_pa_dep                           NUMERIC,
  op_body_shop                        NUMERIC,
  fixed_absorption                    NUMERIC,
  cust_effective_lr_subaru            NUMERIC,
  cust_effective_lr_other             NUMERIC,
  subaru_cust_labor_ro                NUMERIC,
  subaru_cust_labor_sls               NUMERIC,
  subaru_cust_labor_gp                NUMERIC,
  subaru_cust_labor_gp_pct            NUMERIC,
  subaru_warr_labor_ro                NUMERIC,
  subaru_warr_labor_sls               NUMERIC,
  subaru_warr_labor_gp                NUMERIC,
  subaru_warr_labor_gp_pct            NUMERIC,
  subaru_int_labor_ro                 NUMERIC,
  subaru_int_labor_sls                NUMERIC,
  subaru_int_labor_gp                 NUMERIC,
  subaru_int_labor_gp_pct             NUMERIC,
  subaru_prep_maint_ro                NUMERIC,
  subaru_prep_maint_sls               NUMERIC,
  subaru_prep_maint_gp                NUMERIC,
  subaru_prep_maint_gp_pct            NUMERIC,
  subaru_srv_labor_ro                 NUMERIC,
  subaru_srv_labor_sls                NUMERIC,
  subaru_srv_labor_gp                 NUMERIC,
  subaru_srv_labor_gp_pct             NUMERIC,
  subaru_expsrv_labor_ro              NUMERIC,
  subaru_expsrv_labor_sls             NUMERIC,
  subaru_expsrv_labor_gp              NUMERIC,
  subaru_expsrv_labor_gp_pct          NUMERIC,
  total_subaru_srv_labor_ro           NUMERIC,
  total_subaru_srv_labor_sls          NUMERIC,
  total_subaru_srv_labor_gp           NUMERIC,
  total_subaru_srv_labor_gp_pct       NUMERIC,
  subaru_parts_cust_mech_sls          NUMERIC,
  subaru_parts_cust_mech_gp           NUMERIC,
  subaru_parts_cust_mech_gp_pct       NUMERIC,
  subaru_parts_cust_body_sls          NUMERIC,
  subaru_parts_cust_body_gp           NUMERIC,
  subaru_parts_cust_body_gp_pct       NUMERIC,
  subaru_parts_warr_sls               NUMERIC,
  subaru_parts_warr_gp                NUMERIC,
  subaru_parts_warr_gp_pct            NUMERIC,
  subaru_counter_ct                   NUMERIC,
  subaru_counter_sls                  NUMERIC,
  subaru_counter_gp                   NUMERIC,
  subaru_counter_gp_pct               NUMERIC,
  subaru_wholesale_ct                 NUMERIC,
  subaru_wholesale_sls                NUMERIC,
  subaru_wholesale_gp                 NUMERIC,
  subaru_wholesale_gp_pct             NUMERIC,
  subaru_parts_prep_maint_sls         NUMERIC,
  subaru_parts_prep_maint_gp          NUMERIC,
  subaru_parts_prep_maint_gp_pct      NUMERIC,
  suba_pa_sls                         NUMERIC,
  suba_pa_gp                          NUMERIC,
  suba_pa_gp_pct                      NUMERIC,
  suba_pa_exp_sls                     NUMERIC,
  suba_pa_exp_gp                      NUMERIC,
  suba_pa_exp_gp_pct                  NUMERIC,
  tota_subaru_pa_sls                  NUMERIC,
  tota_subaru_pa_gp                   NUMERIC,
  tota_subaru_pa_gp_pct               NUMERIC,
  labor_per_ro_subaru                 NUMERIC,
  parts_labor_sales_ratio             NUMERIC
);


CREATE TABLE IF NOT EXISTS soa_deliver.fact_metrics_agg_region
(
  region                              VARCHAR(8000),
  region_path                         VARCHAR(8000),
  cadence                             VARCHAR(8000),
  compute_period                      VARCHAR(8000),
  period_type                         VARCHAR(8000),
  to_period                           DATE,

  msr                                 NUMERIC,
  msr_pct                             NUMERIC,
  uio                                 NUMERIC,

  -- nwc_target                          NUMERIC,

  tech_training_pct_attainment_target NUMERIC,
  fully_trained_techs_req             NUMERIC,
  fully_trained_techs                 NUMERIC,
  tech_training_credit_taken          NUMERIC,
  tech_training_credit_req            NUMERIC,
  tech_training_pct_attainment        NUMERIC,
  saf_new_accruals                    NUMERIC,                                
  saf_new_expired                     NUMERIC,
  saf_new_utilization                 NUMERIC,
  saf_ps_accruals                     NUMERIC,
  saf_ps_expired                      NUMERIC,
  saf_ps_utilization                  NUMERIC,
  saf_flex_accruals                   NUMERIC,
  saf_flex_expired                    NUMERIC,
  saf_flex_utilization                NUMERIC,
  saf_total_accruals                  NUMERIC,
  saf_total_expired                   NUMERIC,
  saf_total_utilization               NUMERIC,
  saf_care_connect_spend              NUMERIC,
  profitability                       NUMERIC,

  purchase_return_cnt                 NUMERIC,
  purchase_sat_score                  NUMERIC,
  sales_facility_score                NUMERIC,
  sales_consultant_score              NUMERIC,
  purchase_process_score              NUMERIC,
  vehicle_delivery_score              NUMERIC,
  service_return_cnt                  NUMERIC,
  service_sat_score                   NUMERIC,
  service_appt_dropoff_score          NUMERIC,
  service_rep_score                   NUMERIC,
  service_facility_score              NUMERIC,
  vehicle_pickup_process_score        NUMERIC,
  service_quality_score               NUMERIC,
  frft_return_cnt                     NUMERIC,
  frft_pct_yes_score                  NUMERIC,
  frft_pct_routine_maint_yes_score    NUMERIC,
  frft_pct_warranty_yes_score         NUMERIC,

  part_sales                          NUMERIC,
  part_sales_obj                      NUMERIC,
  pct_part_sales_to_obj               NUMERIC,
  sales_rate                          NUMERIC,
  projected_sales                     NUMERIC,
  pct_proj_vs_obj                     NUMERIC,
  port_sales                          NUMERIC,
  port_pnvw                           NUMERIC,
  port_obj                            NUMERIC,
  port_obj_pct                        NUMERIC,
  whs_sales                           NUMERIC,
  whs_pnvw                            NUMERIC,
  whs_obj                             NUMERIC,
  whs_obj_pct                         NUMERIC,
  total_sales                         NUMERIC,
  total_veh                           NUMERIC,
  pnvw                                NUMERIC,
  total_obj                           NUMERIC,
  total_obj_pct                       NUMERIC,
  total_penetration_pct               NUMERIC,
  
  suggested_lines                      NUMERIC,
  accepted_lines                       NUMERIC,
  line_utilization_pct                 NUMERIC,
  suggested_part_no                    NUMERIC,
  override_part_no                     NUMERIC,
  parts_accepted_pct                   NUMERIC,
  net_utilization_pct                  NUMERIC,
  total_on_hand_value                  NUMERIC,
  suggested_on_hand_value              NUMERIC,
  suggested_inventory_pct              NUMERIC,
  overall_performance                  NUMERIC,
  overall_rating                       NUMERIC,
  total_partseye_stock_order_value     NUMERIC,
  total_supplemental_stock_order_value NUMERIC,
  total_emergency_order_value          NUMERIC,
  total_other_order_value              NUMERIC,
  partseye_stockorder_pct              NUMERIC,
  mechanical_off_shelf_fill_rate       NUMERIC,
  mechanical_pieces_sold               NUMERIC,
  mechanical_pieces_sold_from_shelf    NUMERIC,
  mechanical_emergency_orders          NUMERIC,
  mechanical_lost_sales                NUMERIC,
  net_off_shelf_fill_rate_pct          NUMERIC,
  total_off_shelf_fill_rate            NUMERIC,
  lost_sales_part_pct                  NUMERIC,
  lost_sales_total                     NUMERIC,
  total_demand                         NUMERIC,
  total_demand_per_employee_3          NUMERIC,
  total_suggestible_demand             NUMERIC,
  vehicle_sales                       NUMERIC,
  mechanical_sales                    NUMERIC,
  maintenance_sales                   NUMERIC,
  cpo_sales                           NUMERIC,
  total_sales_security                NUMERIC,
  mechanical_penetration_pct          NUMERIC,
  maintenance_penetration_pct         NUMERIC,
  cpo_penetration_pct                 NUMERIC,
  mech_cpo_pen_pct                    NUMERIC,
  mech_cpo_pen_pct_obj                NUMERIC,
  gp_puvr                             NUMERIC,
  op_new_veh                          NUMERIC,
  op_used_veh                         NUMERIC,
  op_service                          NUMERIC,
  op_pa_dep                           NUMERIC,
  op_body_shop                        NUMERIC,
  fixed_absorption                    NUMERIC,
  cust_effective_lr_subaru            NUMERIC,
  cust_effective_lr_other             NUMERIC,
  subaru_cust_labor_ro                NUMERIC,
  subaru_cust_labor_sls               NUMERIC,
  subaru_cust_labor_gp                NUMERIC,
  subaru_cust_labor_gp_pct            NUMERIC,
  subaru_warr_labor_ro                NUMERIC,
  subaru_warr_labor_sls               NUMERIC,
  subaru_warr_labor_gp                NUMERIC,
  subaru_warr_labor_gp_pct            NUMERIC,
  subaru_int_labor_ro                 NUMERIC,
  subaru_int_labor_sls                NUMERIC,
  subaru_int_labor_gp                 NUMERIC,
  subaru_int_labor_gp_pct             NUMERIC,
  subaru_prep_maint_ro                NUMERIC,
  subaru_prep_maint_sls               NUMERIC,
  subaru_prep_maint_gp                NUMERIC,
  subaru_prep_maint_gp_pct            NUMERIC,
  subaru_srv_labor_ro                 NUMERIC,
  subaru_srv_labor_sls                NUMERIC,
  subaru_srv_labor_gp                 NUMERIC,
  subaru_srv_labor_gp_pct             NUMERIC,
  subaru_expsrv_labor_ro              NUMERIC,
  subaru_expsrv_labor_sls             NUMERIC,
  subaru_expsrv_labor_gp              NUMERIC,
  subaru_expsrv_labor_gp_pct          NUMERIC,
  total_subaru_srv_labor_ro           NUMERIC,
  total_subaru_srv_labor_sls          NUMERIC,
  total_subaru_srv_labor_gp           NUMERIC,
  total_subaru_srv_labor_gp_pct       NUMERIC,
  subaru_parts_cust_mech_sls          NUMERIC,
  subaru_parts_cust_mech_gp           NUMERIC,
  subaru_parts_cust_mech_gp_pct       NUMERIC,
  subaru_parts_cust_body_sls          NUMERIC,
  subaru_parts_cust_body_gp           NUMERIC,
  subaru_parts_cust_body_gp_pct       NUMERIC,
  subaru_parts_warr_sls               NUMERIC,
  subaru_parts_warr_gp                NUMERIC,
  subaru_parts_warr_gp_pct            NUMERIC,
  subaru_counter_ct                   NUMERIC,
  subaru_counter_sls                  NUMERIC,
  subaru_counter_gp                   NUMERIC,
  subaru_counter_gp_pct               NUMERIC,
  subaru_wholesale_ct                 NUMERIC,
  subaru_wholesale_sls                NUMERIC,
  subaru_wholesale_gp                 NUMERIC,
  subaru_wholesale_gp_pct             NUMERIC,
  subaru_parts_prep_maint_sls         NUMERIC,
  subaru_parts_prep_maint_gp          NUMERIC,
  subaru_parts_prep_maint_gp_pct      NUMERIC,
  suba_pa_sls                         NUMERIC,
  suba_pa_gp                          NUMERIC,
  suba_pa_gp_pct                      NUMERIC,
  suba_pa_exp_sls                     NUMERIC,
  suba_pa_exp_gp                      NUMERIC,
  suba_pa_exp_gp_pct                  NUMERIC,
  tota_subaru_pa_sls                  NUMERIC,
  tota_subaru_pa_gp                   NUMERIC,
  tota_subaru_pa_gp_pct               NUMERIC,
  labor_per_ro_subaru                 NUMERIC,
  parts_labor_sales_ratio             NUMERIC
);


CREATE TABLE IF NOT EXISTS soa_deliver.fact_metrics_agg_division
(
  division                            VARCHAR(8000),
  division_path                       VARCHAR(8000),
  cadence                             VARCHAR(8000),
  compute_period                      VARCHAR(8000),
  period_type                         VARCHAR(8000),
  to_period                           DATE,

  msr                                 NUMERIC,
  msr_pct                             NUMERIC,
  uio                                 NUMERIC,

  -- nwc_target                          NUMERIC,

  tech_training_pct_attainment_target NUMERIC,
  fully_trained_techs_req             NUMERIC,
  fully_trained_techs                 NUMERIC,
  tech_training_credit_taken          NUMERIC,
  tech_training_credit_req            NUMERIC,
  tech_training_pct_attainment        NUMERIC,
  saf_new_accruals                    NUMERIC,                                
  saf_new_expired                     NUMERIC,
  saf_new_utilization                 NUMERIC,
  saf_ps_accruals                     NUMERIC,
  saf_ps_expired                      NUMERIC,
  saf_ps_utilization                  NUMERIC,
  saf_flex_accruals                   NUMERIC,
  saf_flex_expired                    NUMERIC,
  saf_flex_utilization                NUMERIC,
  saf_total_accruals                  NUMERIC,
  saf_total_expired                   NUMERIC,
  saf_total_utilization               NUMERIC,
  saf_care_connect_spend              NUMERIC,
  profitability                       NUMERIC,

  purchase_return_cnt                 NUMERIC,
  purchase_sat_score                  NUMERIC,
  sales_facility_score                NUMERIC,
  sales_consultant_score              NUMERIC,
  purchase_process_score              NUMERIC,
  vehicle_delivery_score              NUMERIC,
  service_return_cnt                  NUMERIC,
  service_sat_score                   NUMERIC,
  service_appt_dropoff_score          NUMERIC,
  service_rep_score                   NUMERIC,
  service_facility_score              NUMERIC,
  vehicle_pickup_process_score        NUMERIC,
  service_quality_score               NUMERIC,
  frft_return_cnt                     NUMERIC,
  frft_pct_yes_score                  NUMERIC,
  frft_pct_routine_maint_yes_score    NUMERIC,
  frft_pct_warranty_yes_score         NUMERIC,

  part_sales                          NUMERIC,
  part_sales_obj                      NUMERIC,
  pct_part_sales_to_obj               NUMERIC,
  sales_rate                          NUMERIC,
  projected_sales                     NUMERIC,
  pct_proj_vs_obj                     NUMERIC,
  port_sales                          NUMERIC,
  port_pnvw                           NUMERIC,
  port_obj                            NUMERIC,
  port_obj_pct                        NUMERIC,
  whs_sales                           NUMERIC,
  whs_pnvw                            NUMERIC,
  whs_obj                             NUMERIC,
  whs_obj_pct                         NUMERIC,
  total_sales                         NUMERIC,
  total_veh                           NUMERIC,
  pnvw                                NUMERIC,
  total_obj                           NUMERIC,
  total_obj_pct                       NUMERIC,
  total_penetration_pct               NUMERIC,
  
  suggested_lines                      NUMERIC,
  accepted_lines                       NUMERIC,
  line_utilization_pct                 NUMERIC,
  suggested_part_no                    NUMERIC,
  override_part_no                     NUMERIC,
  parts_accepted_pct                   NUMERIC,
  net_utilization_pct                  NUMERIC,
  total_on_hand_value                  NUMERIC,
  suggested_on_hand_value              NUMERIC,
  suggested_inventory_pct              NUMERIC,
  overall_performance                  NUMERIC,
  overall_rating                       NUMERIC,
  total_partseye_stock_order_value     NUMERIC,
  total_supplemental_stock_order_value NUMERIC,
  total_emergency_order_value          NUMERIC,
  total_other_order_value              NUMERIC,
  partseye_stockorder_pct              NUMERIC,
  mechanical_off_shelf_fill_rate       NUMERIC,
  mechanical_pieces_sold               NUMERIC,
  mechanical_pieces_sold_from_shelf    NUMERIC,
  mechanical_emergency_orders          NUMERIC,
  mechanical_lost_sales                NUMERIC,
  net_off_shelf_fill_rate_pct          NUMERIC,
  total_off_shelf_fill_rate            NUMERIC,
  lost_sales_part_pct                  NUMERIC,
  lost_sales_total                     NUMERIC,
  total_demand                         NUMERIC,
  total_demand_per_employee_3          NUMERIC,
  total_suggestible_demand             NUMERIC,
  vehicle_sales                       NUMERIC,
  mechanical_sales                    NUMERIC,
  maintenance_sales                   NUMERIC,
  cpo_sales                           NUMERIC,
  total_sales_security                NUMERIC,
  mechanical_penetration_pct          NUMERIC,
  maintenance_penetration_pct         NUMERIC,
  cpo_penetration_pct                 NUMERIC,
  mech_cpo_pen_pct                    NUMERIC,
  mech_cpo_pen_pct_obj                NUMERIC,
  gp_puvr                             NUMERIC,
  op_new_veh                          NUMERIC,
  op_used_veh                         NUMERIC,
  op_service                          NUMERIC,
  op_pa_dep                           NUMERIC,
  op_body_shop                        NUMERIC,
  fixed_absorption                    NUMERIC,
  cust_effective_lr_subaru            NUMERIC,
  cust_effective_lr_other             NUMERIC,
  subaru_cust_labor_ro                NUMERIC,
  subaru_cust_labor_sls               NUMERIC,
  subaru_cust_labor_gp                NUMERIC,
  subaru_cust_labor_gp_pct            NUMERIC,
  subaru_warr_labor_ro                NUMERIC,
  subaru_warr_labor_sls               NUMERIC,
  subaru_warr_labor_gp                NUMERIC,
  subaru_warr_labor_gp_pct            NUMERIC,
  subaru_int_labor_ro                 NUMERIC,
  subaru_int_labor_sls                NUMERIC,
  subaru_int_labor_gp                 NUMERIC,
  subaru_int_labor_gp_pct             NUMERIC,
  subaru_prep_maint_ro                NUMERIC,
  subaru_prep_maint_sls               NUMERIC,
  subaru_prep_maint_gp                NUMERIC,
  subaru_prep_maint_gp_pct            NUMERIC,
  subaru_srv_labor_ro                 NUMERIC,
  subaru_srv_labor_sls                NUMERIC,
  subaru_srv_labor_gp                 NUMERIC,
  subaru_srv_labor_gp_pct             NUMERIC,
  subaru_expsrv_labor_ro              NUMERIC,
  subaru_expsrv_labor_sls             NUMERIC,
  subaru_expsrv_labor_gp              NUMERIC,
  subaru_expsrv_labor_gp_pct          NUMERIC,
  total_subaru_srv_labor_ro           NUMERIC,
  total_subaru_srv_labor_sls          NUMERIC,
  total_subaru_srv_labor_gp           NUMERIC,
  total_subaru_srv_labor_gp_pct       NUMERIC,
  subaru_parts_cust_mech_sls          NUMERIC,
  subaru_parts_cust_mech_gp           NUMERIC,
  subaru_parts_cust_mech_gp_pct       NUMERIC,
  subaru_parts_cust_body_sls          NUMERIC,
  subaru_parts_cust_body_gp           NUMERIC,
  subaru_parts_cust_body_gp_pct       NUMERIC,
  subaru_parts_warr_sls               NUMERIC,
  subaru_parts_warr_gp                NUMERIC,
  subaru_parts_warr_gp_pct            NUMERIC,
  subaru_counter_ct                   NUMERIC,
  subaru_counter_sls                  NUMERIC,
  subaru_counter_gp                   NUMERIC,
  subaru_counter_gp_pct               NUMERIC,
  subaru_wholesale_ct                 NUMERIC,
  subaru_wholesale_sls                NUMERIC,
  subaru_wholesale_gp                 NUMERIC,
  subaru_wholesale_gp_pct             NUMERIC,
  subaru_parts_prep_maint_sls         NUMERIC,
  subaru_parts_prep_maint_gp          NUMERIC,
  subaru_parts_prep_maint_gp_pct      NUMERIC,
  suba_pa_sls                         NUMERIC,
  suba_pa_gp                          NUMERIC,
  suba_pa_gp_pct                      NUMERIC,
  suba_pa_exp_sls                     NUMERIC,
  suba_pa_exp_gp                      NUMERIC,
  suba_pa_exp_gp_pct                  NUMERIC,
  tota_subaru_pa_sls                  NUMERIC,
  tota_subaru_pa_gp                   NUMERIC,
  tota_subaru_pa_gp_pct               NUMERIC,
  labor_per_ro_subaru                 NUMERIC,
  parts_labor_sales_ratio             NUMERIC
);



-- insert into new tables
insert into soa_deliver.fact_metrics(
cadence                                         ,
entity                                             ,
calendar_date                                    ,
msr                                               ,
msr_pct                                               ,
tech_training_pct_attainment_target               ,
min_tr_techs                                      ,
nbr_fully_tr_techs                                ,
credit_taken                                      ,
credit_req                                        ,
profitability                                     ,
gp_puvr                                           ,
op_new_veh                                        ,
op_used_veh                                       ,
op_service                                        ,
op_pa_dep                                         ,
op_body_shop                                      ,
fixed_absorption                                  ,
cust_effective_lr_subaru                          ,
cust_effective_lr_other                           ,
subaru_cust_labor_ro                              ,
subaru_cust_labor_sls                             ,
subaru_cust_labor_gp                              ,
subaru_cust_labor_gp_pct                          ,
subaru_warr_labor_ro                              ,
subaru_warr_labor_sls                             ,
subaru_warr_labor_gp                              ,
subaru_warr_labor_gp_pct                          ,
subaru_int_labor_ro                               ,
subaru_int_labor_sls                              ,
subaru_int_labor_gp                               ,
subaru_int_labor_gp_pct                           ,
subaru_prep_maint_ro                              ,
subaru_prep_maint_sls                             ,
subaru_prep_maint_gp                              ,
subaru_prep_maint_gp_pct                          ,
subaru_srv_labor_ro                               ,
subaru_srv_labor_sls                              ,
subaru_srv_labor_gp                               ,
subaru_srv_labor_gp_pct                           ,
subaru_expsrv_labor_ro                            ,
subaru_expsrv_labor_sls                           ,
subaru_expsrv_labor_gp                            ,
subaru_expsrv_labor_gp_pct                        ,
total_subaru_srv_labor_ro                         ,
total_subaru_srv_labor_sls                        ,
total_subaru_srv_labor_gp                         ,
total_subaru_srv_labor_gp_pct                     ,
subaru_parts_cust_mech_sls                        ,
subaru_parts_cust_mech_gp                         ,
subaru_parts_cust_mech_gp_pct                     ,
subaru_parts_cust_body_sls                        ,
subaru_parts_cust_body_gp                         ,
subaru_parts_cust_body_gp_pct                     ,
subaru_parts_warr_sls                             ,
subaru_parts_warr_gp                              ,
subaru_parts_warr_gp_pct                          ,
subaru_counter_ct                                 ,
subaru_counter_sls                                ,
subaru_counter_gp                                 ,
subaru_counter_gp_pct                             ,
subaru_wholesale_ct                               ,
subaru_wholesale_sls                              ,
subaru_wholesale_gp                               ,
subaru_wholesale_gp_pct                           ,
subaru_parts_prep_maint_sls                       ,
subaru_parts_prep_maint_gp                        ,
subaru_parts_prep_maint_gp_pct                    ,
suba_pa_sls                                       ,
suba_pa_gp                                        ,
suba_pa_gp_pct                                    ,
suba_pa_exp_sls                                   ,
suba_pa_exp_gp                                    ,
suba_pa_exp_gp_pct                                ,
tota_subaru_pa_sls                                ,
tota_subaru_pa_gp                                 ,
tota_subaru_pa_gp_pct                             ,
labor_per_ro_subaru                               ,
parts_labor_sales_ratio                           ,
uio_entity                                        ,
uio_district                                      ,
uio_zone                                          ,
uio_region                                        ,
uio_division                                      ,
purchase_return_cnt_entity                        ,
purchase_return_cnt_district                      ,
purchase_return_cnt_zone                          ,
purchase_return_cnt_region                        ,
purchase_return_cnt_division                      ,
purchase_sat_score_entity                         ,
purchase_sat_score_district                       ,
purchase_sat_score_zone                           ,
purchase_sat_score_region                         ,
purchase_sat_score_division                       ,
sales_facility_score_entity                       ,
sales_facility_score_district                     ,
sales_facility_score_zone                         ,
sales_facility_score_region                       ,
sales_facility_score_division                     ,
sales_consultant_score_entity                     ,
sales_consultant_score_district                   ,
sales_consultant_score_zone                       ,
sales_consultant_score_region                     ,
sales_consultant_score_division                   ,
purchase_process_score_entity                     ,
purchase_process_score_district                   ,
purchase_process_score_zone                       ,
purchase_process_score_region                     ,
purchase_process_score_division                   ,
vehicle_delivery_score_entity                     ,
vehicle_delivery_score_district                   ,
vehicle_delivery_score_zone                       ,
vehicle_delivery_score_region                     ,
vehicle_delivery_score_division                   ,
service_return_cnt_entity                         ,
service_return_cnt_district                       ,
service_return_cnt_zone                           ,
service_return_cnt_region                         ,
service_return_cnt_division                       ,
service_sat_score_entity                          ,
service_sat_score_district                        ,
service_sat_score_zone                            ,
service_sat_score_region                          ,
service_sat_score_division                        ,
service_appt_dropoff_score_entity                 ,
service_appt_dropoff_score_district               ,
service_appt_dropoff_score_zone                   ,
service_appt_dropoff_score_region                 ,
service_appt_dropoff_score_division               ,
service_rep_score_entity                          ,
service_rep_score_district                        ,
service_rep_score_zone                            ,
service_rep_score_region                          ,
service_rep_score_division                        ,
service_facility_score_entity                     ,
service_facility_score_district                   ,
service_facility_score_zone                       ,
service_facility_score_region                     ,
service_facility_score_division                   ,
vehicle_pickup_process_score_entity               ,
vehicle_pickup_process_score_district             ,
vehicle_pickup_process_score_zone                 ,
vehicle_pickup_process_score_region               ,
vehicle_pickup_process_score_division             ,
service_quality_score_entity                      ,
service_quality_score_district                    ,
service_quality_score_zone                        ,
service_quality_score_region                      ,
service_quality_score_division                    ,
frft_return_cnt_entity                            ,
frft_return_cnt_district                          ,
frft_return_cnt_zone                              ,
frft_return_cnt_region                            ,
frft_return_cnt_division                          ,
frft_pct_yes_score_entity                         ,
frft_pct_yes_score_district                       ,
frft_pct_yes_score_zone                           ,
frft_pct_yes_score_region                         ,
frft_pct_yes_score_division                       ,
frft_pct_routine_maint_yes_score_entity           ,
frft_pct_routine_maint_yes_score_district         ,
frft_pct_routine_maint_yes_score_zone             ,
frft_pct_routine_maint_yes_score_region           ,
frft_pct_routine_maint_yes_score_division         ,
frft_pct_warranty_yes_score_entity                ,
frft_pct_warranty_yes_score_district              ,
frft_pct_warranty_yes_score_zone                  ,
frft_pct_warranty_yes_score_region                ,
frft_pct_warranty_yes_score_division             ,
part_sales_entity                                 ,
part_sales_district                               ,
part_sales_zone                                   ,
part_sales_region                                 ,
part_sales_division                               ,
part_sales_obj_entity                             ,
part_sales_obj_district                           ,
part_sales_obj_zone                               ,
part_sales_obj_region                             ,
part_sales_obj_division                           ,
pct_part_sales_to_obj_entity                      ,
pct_part_sales_to_obj_district                    ,
pct_part_sales_to_obj_zone                        ,
pct_part_sales_to_obj_region                      ,
pct_part_sales_to_obj_division                    ,
sales_rate_entity                                 ,
sales_rate_district                               ,
sales_rate_zone                                   ,
sales_rate_region                                 ,
sales_rate_division                               ,
projected_sales_entity                            ,
projected_sales_district                          ,
projected_sales_zone                              ,
projected_sales_region                            ,
projected_sales_division                          ,
pct_proj_vs_obj_entity                            ,
pct_proj_vs_obj_district                          ,
pct_proj_vs_obj_zone                              ,
pct_proj_vs_obj_region                            ,
pct_proj_vs_obj_division                          ,
port_sales_entity                                 ,
port_sales_district                               ,
port_sales_zone                                   ,
port_sales_region                                 ,
port_sales_division                               ,
port_pnvw_entity                                  ,
port_pnvw_district                                ,
port_pnvw_zone                                    ,
port_pnvw_region                                  ,
port_pnvw_division                                ,
port_obj_entity                                   ,
port_obj_district                                 ,
port_obj_zone                                     ,
port_obj_region                                   ,
port_obj_division                                 ,
port_obj_pct_entity                               ,
port_obj_pct_district                             ,
port_obj_pct_zone                                 ,
port_obj_pct_region                               ,
port_obj_pct_division                             ,
whs_sales_entity                                  ,
whs_sales_district                                ,
whs_sales_zone                                    ,
whs_sales_region                                  ,
whs_sales_division                                ,
whs_pnvw_entity                                   ,
whs_pnvw_district                                 ,
whs_pnvw_zone                                     ,
whs_pnvw_region                                   ,
whs_pnvw_division                                 ,
whs_obj_entity                                    ,
whs_obj_district                                  ,
whs_obj_zone                                      ,
whs_obj_region                                    ,
whs_obj_division                                  ,
whs_obj_pct_entity                                ,
whs_obj_pct_district                              ,
whs_obj_pct_zone                                  ,
whs_obj_pct_region                                ,
whs_obj_pct_division                              ,
total_sales_entity                                ,
total_sales_district                              ,
total_sales_zone                                  ,
total_sales_region                                ,
total_sales_division                              ,
total_veh_entity                                  ,
total_veh_district                                ,
total_veh_zone                                    ,
total_veh_region                                  ,
total_veh_division                                ,
pnvw_entity                                       ,
pnvw_district                                     ,
pnvw_zone                                         ,
pnvw_region                                       ,
pnvw_division                                     ,
total_obj_entity                                  ,
total_obj_district                                ,
total_obj_zone                                    ,
total_obj_region                                  ,
total_obj_division                                ,
total_obj_pct_entity                              ,
total_obj_pct_district                            ,
total_obj_pct_zone                                ,
total_obj_pct_region                              ,
total_obj_pct_division                            ,
total_penetration_pct_entity                      ,
total_penetration_pct_district                    ,
total_penetration_pct_zone                        ,
total_penetration_pct_region                      ,
total_penetration_pct_division                    ,
suggested_lines_entity                            ,
suggested_lines_district                          ,
suggested_lines_zone                              ,
suggested_lines_region                            ,
suggested_lines_division                          ,
accepted_lines_entity                             ,
accepted_lines_district                           ,
accepted_lines_zone                               ,
accepted_lines_region                             ,
accepted_lines_division                           ,
line_utilization_pct_entity                       ,
line_utilization_pct_district                     ,
line_utilization_pct_zone                         ,
line_utilization_pct_region                       ,
line_utilization_pct_division                     ,
suggested_part_no_entity                          ,
suggested_part_no_district                        ,
suggested_part_no_zone                            ,
suggested_part_no_region                          ,
suggested_part_no_division                        ,
override_part_no_entity                           ,
override_part_no_district                         ,
override_part_no_zone                             ,
override_part_no_region                           ,
override_part_no_division                         ,
parts_accepted_pct_entity                         ,
parts_accepted_pct_district                       ,
parts_accepted_pct_zone                           ,
parts_accepted_pct_region                         ,
parts_accepted_pct_division                       ,
net_utilization_pct_entity                        ,
net_utilization_pct_district                      ,
net_utilization_pct_zone                          ,
net_utilization_pct_region                        ,
net_utilization_pct_division                      ,
total_on_hand_value_entity                        ,
total_on_hand_value_district                      ,
total_on_hand_value_zone                          ,
total_on_hand_value_region                        ,
total_on_hand_value_division                      ,
suggested_on_hand_value_entity                    ,
suggested_on_hand_value_district                  ,
suggested_on_hand_value_zone                      ,
suggested_on_hand_value_region                    ,
suggested_on_hand_value_division                  ,
suggested_inventory_pct_entity                    ,
suggested_inventory_pct_district                  ,
suggested_inventory_pct_zone                      ,
suggested_inventory_pct_region                    ,
suggested_inventory_pct_division                  ,
overall_performance_entity                        ,
overall_performance_district                      ,
overall_performance_zone                          ,
overall_performance_region                        ,
overall_performance_division                      ,
overall_rating_entity                             ,
overall_rating_district                           ,
overall_rating_zone                               ,
overall_rating_region                             ,
overall_rating_division                           ,
total_partseye_stock_order_value_entity           ,
total_partseye_stock_order_value_district         ,
total_partseye_stock_order_value_zone             ,
total_partseye_stock_order_value_region           ,
total_partseye_stock_order_value_division         ,
total_supplemental_stock_order_value_entity       ,
total_supplemental_stock_order_value_district     ,
total_supplemental_stock_order_value_zone         ,
total_supplemental_stock_order_value_region       ,
total_supplemental_stock_order_value_division     ,
total_emergency_order_value_entity                ,
total_emergency_order_value_district              ,
total_emergency_order_value_zone                  ,
total_emergency_order_value_region                ,
total_emergency_order_value_division              ,
total_other_order_value_entity                    ,
total_other_order_value_district                  ,
total_other_order_value_zone                      ,
total_other_order_value_region                    ,
total_other_order_value_division                  ,
partseye_stockorder_pct_entity                    ,
partseye_stockorder_pct_district                  ,
partseye_stockorder_pct_zone                      ,
partseye_stockorder_pct_region                    ,
partseye_stockorder_pct_division                  ,
mechanical_off_shelf_fill_rate_entity             ,
mechanical_off_shelf_fill_rate_district           ,
mechanical_off_shelf_fill_rate_zone               ,
mechanical_off_shelf_fill_rate_region             ,
mechanical_off_shelf_fill_rate_division           ,
mechanical_pieces_sold_entity                     ,
mechanical_pieces_sold_district                   ,
mechanical_pieces_sold_zone                       ,
mechanical_pieces_sold_region                     ,
mechanical_pieces_sold_division                   ,
mechanical_pieces_sold_from_shelf_entity          ,
mechanical_pieces_sold_from_shelf_district        ,
mechanical_pieces_sold_from_shelf_zone            ,
mechanical_pieces_sold_from_shelf_region          ,
mechanical_pieces_sold_from_shelf_division        ,
mechanical_emergency_orders_entity                ,
mechanical_emergency_orders_district              ,
mechanical_emergency_orders_zone                  ,
mechanical_emergency_orders_region                ,
mechanical_emergency_orders_division              ,
mechanical_lost_sales_entity                      ,
mechanical_lost_sales_district                    ,
mechanical_lost_sales_zone                        ,
mechanical_lost_sales_region                      ,
mechanical_lost_sales_division                    ,
net_off_shelf_fill_rate_pct_entity                ,
net_off_shelf_fill_rate_pct_district              ,
net_off_shelf_fill_rate_pct_zone                  ,
net_off_shelf_fill_rate_pct_region                ,
net_off_shelf_fill_rate_pct_division              ,
total_off_shelf_fill_rate_entity                  ,
total_off_shelf_fill_rate_district                ,
total_off_shelf_fill_rate_zone                    ,
total_off_shelf_fill_rate_region                  ,
total_off_shelf_fill_rate_division                ,
lost_sales_part_pct_entity                        ,
lost_sales_part_pct_district                      ,
lost_sales_part_pct_zone                          ,
lost_sales_part_pct_region                        ,
lost_sales_part_pct_division                      ,
lost_sales_total_entity                           ,
lost_sales_total_district                         ,
lost_sales_total_zone                             ,
lost_sales_total_region                           ,
lost_sales_total_division                         ,
total_demand_entity                               ,
total_demand_district                             ,
total_demand_zone                                 ,
total_demand_region                               ,
total_demand_division                             ,
total_demand_per_employee_3_entity                ,
total_demand_per_employee_3_district              ,
total_demand_per_employee_3_zone                  ,
total_demand_per_employee_3_region                ,
total_demand_per_employee_3_division              ,
total_suggestible_demand_entity                   ,
total_suggestible_demand_district                 ,
total_suggestible_demand_zone                     ,
total_suggestible_demand_region                   ,
total_suggestible_demand_division                 ,
msr_last_update                                  ,
msr_pct_last_update                              ,
uio_last_update                                  ,
nwc_target_last_update                           ,
tech_training_pct_attainment_target_last_update  ,
fully_trained_techs_req_last_update              ,
fully_trained_techs_last_update                  ,
tech_training_credit_taken_last_update           ,
tech_training_credit_req_last_update             ,
purchase_return_cnt_last_update                  ,
purchase_sat_score_last_update                   ,
sales_facility_score_last_update                 ,
sales_consultant_score_last_update               ,
purchase_process_score_last_update               ,
vehicle_delivery_score_last_update               ,
service_return_cnt_last_update                   ,
service_sat_score_last_update                    ,
service_appt_dropoff_score_last_update           ,
service_rep_score_last_update                    ,
service_facility_score_last_update               ,
vehicle_pickup_process_score_last_update         ,
service_quality_score_last_update                ,
frft_return_cnt_last_update                      ,
frft_pct_yes_score_last_update                   ,
frft_pct_routine_maint_yes_score_last_update     ,
frft_pct_warranty_yes_score_last_update          ,
part_sales_last_update                           ,
part_sales_obj_last_update                       ,
pct_part_sales_to_obj_last_update                ,
sales_rate_last_update                           ,
projected_sales_last_update                      ,
pct_proj_vs_obj_last_update                      ,
port_sales_last_update                           ,
port_pnvw_last_update                            ,
port_obj_last_update                             ,
port_obj_pct_last_update                         ,
whs_sales_last_update                            ,
whs_pnvw_last_update                             ,
whs_obj_last_update                              ,
whs_obj_pct_last_update                          ,
total_sales_last_update                          ,
total_veh_last_update                            ,
pnvw_last_update                                 ,
total_obj_last_update                            ,
total_obj_pct_last_update                    
)
(select 
cadence                                         ,
entity                                             ,
calendar_date                                    ,
msr                                               ,
msr_pct                                               ,
tech_training_pct_attainment_target               ,
min_tr_techs                                      ,
nbr_fully_tr_techs                                ,
credit_taken                                      ,
credit_req                                        ,
profitability                                     ,
gp_puvr                                           ,
op_new_veh                                        ,
op_used_veh                                       ,
op_service                                        ,
op_pa_dep                                         ,
op_body_shop                                      ,
fixed_absorption                                  ,
cust_effective_lr_subaru                          ,
cust_effective_lr_other                           ,
subaru_cust_labor_ro                              ,
subaru_cust_labor_sls                             ,
subaru_cust_labor_gp                              ,
subaru_cust_labor_gp_pct                          ,
subaru_warr_labor_ro                              ,
subaru_warr_labor_sls                             ,
subaru_warr_labor_gp                              ,
subaru_warr_labor_gp_pct                          ,
subaru_int_labor_ro                               ,
subaru_int_labor_sls                              ,
subaru_int_labor_gp                               ,
subaru_int_labor_gp_pct                           ,
subaru_prep_maint_ro                              ,
subaru_prep_maint_sls                             ,
subaru_prep_maint_gp                              ,
subaru_prep_maint_gp_pct                          ,
subaru_srv_labor_ro                               ,
subaru_srv_labor_sls                              ,
subaru_srv_labor_gp                               ,
subaru_srv_labor_gp_pct                           ,
subaru_expsrv_labor_ro                            ,
subaru_expsrv_labor_sls                           ,
subaru_expsrv_labor_gp                            ,
subaru_expsrv_labor_gp_pct                        ,
total_subaru_srv_labor_ro                         ,
total_subaru_srv_labor_sls                        ,
total_subaru_srv_labor_gp                         ,
total_subaru_srv_labor_gp_pct                     ,
subaru_parts_cust_mech_sls                        ,
subaru_parts_cust_mech_gp                         ,
subaru_parts_cust_mech_gp_pct                     ,
subaru_parts_cust_body_sls                        ,
subaru_parts_cust_body_gp                         ,
subaru_parts_cust_body_gp_pct                     ,
subaru_parts_warr_sls                             ,
subaru_parts_warr_gp                              ,
subaru_parts_warr_gp_pct                          ,
subaru_counter_ct                                 ,
subaru_counter_sls                                ,
subaru_counter_gp                                 ,
subaru_counter_gp_pct                             ,
subaru_wholesale_ct                               ,
subaru_wholesale_sls                              ,
subaru_wholesale_gp                               ,
subaru_wholesale_gp_pct                           ,
subaru_parts_prep_maint_sls                       ,
subaru_parts_prep_maint_gp                        ,
subaru_parts_prep_maint_gp_pct                    ,
suba_pa_sls                                       ,
suba_pa_gp                                        ,
suba_pa_gp_pct                                    ,
suba_pa_exp_sls                                   ,
suba_pa_exp_gp                                    ,
suba_pa_exp_gp_pct                                ,
tota_subaru_pa_sls                                ,
tota_subaru_pa_gp                                 ,
tota_subaru_pa_gp_pct                             ,
labor_per_ro_subaru                               ,
parts_labor_sales_ratio                           ,
uio_entity                                        ,
uio_district                                      ,
uio_zone                                          ,
uio_region                                        ,
uio_division                                      ,
purchase_return_cnt_entity                        ,
purchase_return_cnt_district                      ,
purchase_return_cnt_zone                          ,
purchase_return_cnt_region                        ,
purchase_return_cnt_division                      ,
purchase_sat_score_entity                         ,
purchase_sat_score_district                       ,
purchase_sat_score_zone                           ,
purchase_sat_score_region                         ,
purchase_sat_score_division                       ,
sales_facility_score_entity                       ,
sales_facility_score_district                     ,
sales_facility_score_zone                         ,
sales_facility_score_region                       ,
sales_facility_score_division                     ,
sales_consultant_score_entity                     ,
sales_consultant_score_district                   ,
sales_consultant_score_zone                       ,
sales_consultant_score_region                     ,
sales_consultant_score_division                   ,
purchase_process_score_entity                     ,
purchase_process_score_district                   ,
purchase_process_score_zone                       ,
purchase_process_score_region                     ,
purchase_process_score_division                   ,
vehicle_delivery_score_entity                     ,
vehicle_delivery_score_district                   ,
vehicle_delivery_score_zone                       ,
vehicle_delivery_score_region                     ,
vehicle_delivery_score_division                   ,
service_return_cnt_entity                         ,
service_return_cnt_district                       ,
service_return_cnt_zone                           ,
service_return_cnt_region                         ,
service_return_cnt_division                       ,
service_sat_score_entity                          ,
service_sat_score_district                        ,
service_sat_score_zone                            ,
service_sat_score_region                          ,
service_sat_score_division                        ,
service_appt_dropoff_score_entity                 ,
service_appt_dropoff_score_district               ,
service_appt_dropoff_score_zone                   ,
service_appt_dropoff_score_region                 ,
service_appt_dropoff_score_division               ,
service_rep_score_entity                          ,
service_rep_score_district                        ,
service_rep_score_zone                            ,
service_rep_score_region                          ,
service_rep_score_division                        ,
service_facility_score_entity                     ,
service_facility_score_district                   ,
service_facility_score_zone                       ,
service_facility_score_region                     ,
service_facility_score_division                   ,
vehicle_pickup_process_score_entity               ,
vehicle_pickup_process_score_district             ,
vehicle_pickup_process_score_zone                 ,
vehicle_pickup_process_score_region               ,
vehicle_pickup_process_score_division             ,
service_quality_score_entity                      ,
service_quality_score_district                    ,
service_quality_score_zone                        ,
service_quality_score_region                      ,
service_quality_score_division                    ,
frft_return_cnt_entity                            ,
frft_return_cnt_district                          ,
frft_return_cnt_zone                              ,
frft_return_cnt_region                            ,
frft_return_cnt_division                          ,
frft_pct_yes_score_entity                         ,
frft_pct_yes_score_district                       ,
frft_pct_yes_score_zone                           ,
frft_pct_yes_score_region                         ,
frft_pct_yes_score_division                       ,
frft_pct_routine_maint_yes_score_entity           ,
frft_pct_routine_maint_yes_score_district         ,
frft_pct_routine_maint_yes_score_zone             ,
frft_pct_routine_maint_yes_score_region           ,
frft_pct_routine_maint_yes_score_division         ,
frft_pct_warranty_yes_score_entity                ,
frft_pct_warranty_yes_score_district              ,
frft_pct_warranty_yes_score_zone                  ,
frft_pct_warranty_yes_score_region                ,
frft_pct_warranty_yes_score_division             ,
part_sales_entity                                 ,
part_sales_district                               ,
part_sales_zone                                   ,
part_sales_region                                 ,
part_sales_division                               ,
part_sales_obj_entity                             ,
part_sales_obj_district                           ,
part_sales_obj_zone                               ,
part_sales_obj_region                             ,
part_sales_obj_division                           ,
pct_part_sales_to_obj_entity                      ,
pct_part_sales_to_obj_district                    ,
pct_part_sales_to_obj_zone                        ,
pct_part_sales_to_obj_region                      ,
pct_part_sales_to_obj_division                    ,
sales_rate_entity                                 ,
sales_rate_district                               ,
sales_rate_zone                                   ,
sales_rate_region                                 ,
sales_rate_division                               ,
projected_sales_entity                            ,
projected_sales_district                          ,
projected_sales_zone                              ,
projected_sales_region                            ,
projected_sales_division                          ,
pct_proj_vs_obj_entity                            ,
pct_proj_vs_obj_district                          ,
pct_proj_vs_obj_zone                              ,
pct_proj_vs_obj_region                            ,
pct_proj_vs_obj_division                          ,
port_sales_entity                                 ,
port_sales_district                               ,
port_sales_zone                                   ,
port_sales_region                                 ,
port_sales_division                               ,
port_pnvw_entity                                  ,
port_pnvw_district                                ,
port_pnvw_zone                                    ,
port_pnvw_region                                  ,
port_pnvw_division                                ,
port_obj_entity                                   ,
port_obj_district                                 ,
port_obj_zone                                     ,
port_obj_region                                   ,
port_obj_division                                 ,
port_obj_pct_entity                               ,
port_obj_pct_district                             ,
port_obj_pct_zone                                 ,
port_obj_pct_region                               ,
port_obj_pct_division                             ,
whs_sales_entity                                  ,
whs_sales_district                                ,
whs_sales_zone                                    ,
whs_sales_region                                  ,
whs_sales_division                                ,
whs_pnvw_entity                                   ,
whs_pnvw_district                                 ,
whs_pnvw_zone                                     ,
whs_pnvw_region                                   ,
whs_pnvw_division                                 ,
whs_obj_entity                                    ,
whs_obj_district                                  ,
whs_obj_zone                                      ,
whs_obj_region                                    ,
whs_obj_division                                  ,
whs_obj_pct_entity                                ,
whs_obj_pct_district                              ,
whs_obj_pct_zone                                  ,
whs_obj_pct_region                                ,
whs_obj_pct_division                              ,
total_sales_entity                                ,
total_sales_district                              ,
total_sales_zone                                  ,
total_sales_region                                ,
total_sales_division                              ,
total_veh_entity                                  ,
total_veh_district                                ,
total_veh_zone                                    ,
total_veh_region                                  ,
total_veh_division                                ,
pnvw_entity                                       ,
pnvw_district                                     ,
pnvw_zone                                         ,
pnvw_region                                       ,
pnvw_division                                     ,
total_obj_entity                                  ,
total_obj_district                                ,
total_obj_zone                                    ,
total_obj_region                                  ,
total_obj_division                                ,
total_obj_pct_entity                              ,
total_obj_pct_district                            ,
total_obj_pct_zone                                ,
total_obj_pct_region                              ,
total_obj_pct_division                            ,
total_penetration_pct_entity                      ,
total_penetration_pct_district                    ,
total_penetration_pct_zone                        ,
total_penetration_pct_region                      ,
total_penetration_pct_division                    ,
suggested_lines_entity                            ,
suggested_lines_district                          ,
suggested_lines_zone                              ,
suggested_lines_region                            ,
suggested_lines_division                          ,
accepted_lines_entity                             ,
accepted_lines_district                           ,
accepted_lines_zone                               ,
accepted_lines_region                             ,
accepted_lines_division                           ,
line_utilization_pct_entity                       ,
line_utilization_pct_district                     ,
line_utilization_pct_zone                         ,
line_utilization_pct_region                       ,
line_utilization_pct_division                     ,
suggested_part_no_entity                          ,
suggested_part_no_district                        ,
suggested_part_no_zone                            ,
suggested_part_no_region                          ,
suggested_part_no_division                        ,
override_part_no_entity                           ,
override_part_no_district                         ,
override_part_no_zone                             ,
override_part_no_region                           ,
override_part_no_division                         ,
parts_accepted_pct_entity                         ,
parts_accepted_pct_district                       ,
parts_accepted_pct_zone                           ,
parts_accepted_pct_region                         ,
parts_accepted_pct_division                       ,
net_utilization_pct_entity                        ,
net_utilization_pct_district                      ,
net_utilization_pct_zone                          ,
net_utilization_pct_region                        ,
net_utilization_pct_division                      ,
total_on_hand_value_entity                        ,
total_on_hand_value_district                      ,
total_on_hand_value_zone                          ,
total_on_hand_value_region                        ,
total_on_hand_value_division                      ,
suggested_on_hand_value_entity                    ,
suggested_on_hand_value_district                  ,
suggested_on_hand_value_zone                      ,
suggested_on_hand_value_region                    ,
suggested_on_hand_value_division                  ,
suggested_inventory_pct_entity                    ,
suggested_inventory_pct_district                  ,
suggested_inventory_pct_zone                      ,
suggested_inventory_pct_region                    ,
suggested_inventory_pct_division                  ,
overall_performance_entity                        ,
overall_performance_district                      ,
overall_performance_zone                          ,
overall_performance_region                        ,
overall_performance_division                      ,
overall_rating_entity                             ,
overall_rating_district                           ,
overall_rating_zone                               ,
overall_rating_region                             ,
overall_rating_division                           ,
total_partseye_stock_order_value_entity           ,
total_partseye_stock_order_value_district         ,
total_partseye_stock_order_value_zone             ,
total_partseye_stock_order_value_region           ,
total_partseye_stock_order_value_division         ,
total_supplemental_stock_order_value_entity       ,
total_supplemental_stock_order_value_district     ,
total_supplemental_stock_order_value_zone         ,
total_supplemental_stock_order_value_region       ,
total_supplemental_stock_order_value_division     ,
total_emergency_order_value_entity                ,
total_emergency_order_value_district              ,
total_emergency_order_value_zone                  ,
total_emergency_order_value_region                ,
total_emergency_order_value_division              ,
total_other_order_value_entity                    ,
total_other_order_value_district                  ,
total_other_order_value_zone                      ,
total_other_order_value_region                    ,
total_other_order_value_division                  ,
partseye_stockorder_pct_entity                    ,
partseye_stockorder_pct_district                  ,
partseye_stockorder_pct_zone                      ,
partseye_stockorder_pct_region                    ,
partseye_stockorder_pct_division                  ,
mechanical_off_shelf_fill_rate_entity             ,
mechanical_off_shelf_fill_rate_district           ,
mechanical_off_shelf_fill_rate_zone               ,
mechanical_off_shelf_fill_rate_region             ,
mechanical_off_shelf_fill_rate_division           ,
mechanical_pieces_sold_entity                     ,
mechanical_pieces_sold_district                   ,
mechanical_pieces_sold_zone                       ,
mechanical_pieces_sold_region                     ,
mechanical_pieces_sold_division                   ,
mechanical_pieces_sold_from_shelf_entity          ,
mechanical_pieces_sold_from_shelf_district        ,
mechanical_pieces_sold_from_shelf_zone            ,
mechanical_pieces_sold_from_shelf_region          ,
mechanical_pieces_sold_from_shelf_division        ,
mechanical_emergency_orders_entity                ,
mechanical_emergency_orders_district              ,
mechanical_emergency_orders_zone                  ,
mechanical_emergency_orders_region                ,
mechanical_emergency_orders_division              ,
mechanical_lost_sales_entity                      ,
mechanical_lost_sales_district                    ,
mechanical_lost_sales_zone                        ,
mechanical_lost_sales_region                      ,
mechanical_lost_sales_division                    ,
net_off_shelf_fill_rate_pct_entity                ,
net_off_shelf_fill_rate_pct_district              ,
net_off_shelf_fill_rate_pct_zone                  ,
net_off_shelf_fill_rate_pct_region                ,
net_off_shelf_fill_rate_pct_division              ,
total_off_shelf_fill_rate_entity                  ,
total_off_shelf_fill_rate_district                ,
total_off_shelf_fill_rate_zone                    ,
total_off_shelf_fill_rate_region                  ,
total_off_shelf_fill_rate_division                ,
lost_sales_part_pct_entity                        ,
lost_sales_part_pct_district                      ,
lost_sales_part_pct_zone                          ,
lost_sales_part_pct_region                        ,
lost_sales_part_pct_division                      ,
lost_sales_total_entity                           ,
lost_sales_total_district                         ,
lost_sales_total_zone                             ,
lost_sales_total_region                           ,
lost_sales_total_division                         ,
total_demand_entity                               ,
total_demand_district                             ,
total_demand_zone                                 ,
total_demand_region                               ,
total_demand_division                             ,
total_demand_per_employee_3_entity                ,
total_demand_per_employee_3_district              ,
total_demand_per_employee_3_zone                  ,
total_demand_per_employee_3_region                ,
total_demand_per_employee_3_division              ,
total_suggestible_demand_entity                   ,
total_suggestible_demand_district                 ,
total_suggestible_demand_zone                     ,
total_suggestible_demand_region                   ,
total_suggestible_demand_division                 ,
msr_last_update                                  ,
msr_pct_last_update                              ,
uio_last_update                                  ,
nwc_target_last_update                           ,
tech_training_pct_attainment_target_last_update  ,
fully_trained_techs_req_last_update              ,
fully_trained_techs_last_update                  ,
tech_training_credit_taken_last_update           ,
tech_training_credit_req_last_update             ,
purchase_return_cnt_last_update                  ,
purchase_sat_score_last_update                   ,
sales_facility_score_last_update                 ,
sales_consultant_score_last_update               ,
purchase_process_score_last_update               ,
vehicle_delivery_score_last_update               ,
service_return_cnt_last_update                   ,
service_sat_score_last_update                    ,
service_appt_dropoff_score_last_update           ,
service_rep_score_last_update                    ,
service_facility_score_last_update               ,
vehicle_pickup_process_score_last_update         ,
service_quality_score_last_update                ,
frft_return_cnt_last_update                      ,
frft_pct_yes_score_last_update                   ,
frft_pct_routine_maint_yes_score_last_update     ,
frft_pct_warranty_yes_score_last_update          ,
part_sales_last_update                           ,
part_sales_obj_last_update                       ,
pct_part_sales_to_obj_last_update                ,
sales_rate_last_update                           ,
projected_sales_last_update                      ,
pct_proj_vs_obj_last_update                      ,
port_sales_last_update                           ,
port_pnvw_last_update                            ,
port_obj_last_update                             ,
port_obj_pct_last_update                         ,
whs_sales_last_update                            ,
whs_pnvw_last_update                             ,
whs_obj_last_update                              ,
whs_obj_pct_last_update                          ,
total_sales_last_update                          ,
total_veh_last_update                            ,
pnvw_last_update                                 ,
total_obj_last_update                            ,
total_obj_pct_last_update                    

from fact_metrics_temp);


insert into soa_deliver.fact_metrics_agg_entity(
entity                               ,
entity_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
)
(select 
entity                               ,
entity_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
from fact_metrics_agg_entity_temp);


insert into soa_deliver.fact_metrics_agg_district(
district                               ,
district_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
)
(select 
district                               ,
district_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
from fact_metrics_agg_district_temp);


insert into soa_deliver.fact_metrics_agg_zone(
zone                               ,
zone_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
)
(select 
zone                               ,
zone_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
 from fact_metrics_agg_zone_temp);


insert into soa_deliver.fact_metrics_agg_region(
region                               ,
region_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
)
(select 
region                               ,
region_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
 from fact_metrics_agg_region_temp);


insert into soa_deliver.fact_metrics_agg_division(
division                               ,
division_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
)
(select 
division                               ,
division_path                          ,
cadence                              ,
compute_period                       ,
period_type                          ,
to_period                            ,
msr                                  ,
msr_pct                              ,
uio                                  ,
tech_training_pct_attainment_target  ,
fully_trained_techs_req              ,
fully_trained_techs                  ,
tech_training_credit_taken           ,
tech_training_credit_req             ,
tech_training_pct_attainment         ,

profitability                        ,

purchase_return_cnt                  ,
purchase_sat_score                   ,
sales_facility_score                 ,
sales_consultant_score               ,
purchase_process_score               ,
vehicle_delivery_score               ,
service_return_cnt                   ,
service_sat_score                    ,
service_appt_dropoff_score           ,
service_rep_score                    ,
service_facility_score               ,
vehicle_pickup_process_score         ,
service_quality_score                ,
frft_return_cnt                      ,
frft_pct_yes_score                   ,
frft_pct_routine_maint_yes_score     ,
frft_pct_warranty_yes_score          ,

part_sales                           ,
part_sales_obj                       ,
pct_part_sales_to_obj                ,
sales_rate                           ,
projected_sales                      ,
pct_proj_vs_obj                      ,
port_sales                           ,
port_pnvw                            ,
port_obj                             ,
port_obj_pct                         ,
whs_sales                            ,
whs_pnvw                             ,
whs_obj                              ,
whs_obj_pct                          ,
total_sales                          ,
total_veh                            ,
pnvw                                 ,
total_obj                            ,
total_obj_pct                        ,
total_penetration_pct                ,

suggested_lines                       ,
accepted_lines                        ,
line_utilization_pct                  ,
suggested_part_no                     ,
override_part_no                      ,
parts_accepted_pct                    ,
net_utilization_pct                   ,
total_on_hand_value                   ,
suggested_on_hand_value               ,
suggested_inventory_pct               ,
overall_performance                   ,
overall_rating                        ,
total_partseye_stock_order_value      ,
total_supplemental_stock_order_value  ,
total_emergency_order_value           ,
total_other_order_value               ,
partseye_stockorder_pct               ,
mechanical_off_shelf_fill_rate        ,
mechanical_pieces_sold                ,
mechanical_pieces_sold_from_shelf     ,
mechanical_emergency_orders           ,
mechanical_lost_sales                 ,
net_off_shelf_fill_rate_pct           ,
total_off_shelf_fill_rate             ,
lost_sales_part_pct                   ,
lost_sales_total                      ,
total_demand                          ,
total_demand_per_employee_3           ,
total_suggestible_demand              ,
gp_puvr                              ,
op_new_veh                           ,
op_used_veh                          ,
op_service                           ,
op_pa_dep                            ,
op_body_shop                         ,
fixed_absorption                     ,
cust_effective_lr_subaru             ,
cust_effective_lr_other              ,
subaru_cust_labor_ro                 ,
subaru_cust_labor_sls                ,
subaru_cust_labor_gp                 ,
subaru_cust_labor_gp_pct             ,
subaru_warr_labor_ro                 ,
subaru_warr_labor_sls                ,
subaru_warr_labor_gp                 ,
subaru_warr_labor_gp_pct             ,
subaru_int_labor_ro                  ,
subaru_int_labor_sls                 ,
subaru_int_labor_gp                  ,
subaru_int_labor_gp_pct              ,
subaru_prep_maint_ro                 ,
subaru_prep_maint_sls                ,
subaru_prep_maint_gp                 ,
subaru_prep_maint_gp_pct             ,
subaru_srv_labor_ro                  ,
subaru_srv_labor_sls                 ,
subaru_srv_labor_gp                  ,
subaru_srv_labor_gp_pct              ,
subaru_expsrv_labor_ro               ,
subaru_expsrv_labor_sls              ,
subaru_expsrv_labor_gp               ,
subaru_expsrv_labor_gp_pct           ,
total_subaru_srv_labor_ro            ,
total_subaru_srv_labor_sls           ,
total_subaru_srv_labor_gp            ,
total_subaru_srv_labor_gp_pct        ,
subaru_parts_cust_mech_sls           ,
subaru_parts_cust_mech_gp            ,
subaru_parts_cust_mech_gp_pct        ,
subaru_parts_cust_body_sls           ,
subaru_parts_cust_body_gp            ,
subaru_parts_cust_body_gp_pct        ,
subaru_parts_warr_sls                ,
subaru_parts_warr_gp                 ,
subaru_parts_warr_gp_pct             ,
subaru_counter_ct                    ,
subaru_counter_sls                   ,
subaru_counter_gp                    ,
subaru_counter_gp_pct                ,
subaru_wholesale_ct                  ,
subaru_wholesale_sls                 ,
subaru_wholesale_gp                  ,
subaru_wholesale_gp_pct              ,
subaru_parts_prep_maint_sls          ,
subaru_parts_prep_maint_gp           ,
subaru_parts_prep_maint_gp_pct       ,
suba_pa_sls                          ,
suba_pa_gp                           ,
suba_pa_gp_pct                       ,
suba_pa_exp_sls                      ,
suba_pa_exp_gp                       ,
suba_pa_exp_gp_pct                   ,
tota_subaru_pa_sls                   ,
tota_subaru_pa_gp                    ,
tota_subaru_pa_gp_pct                ,
labor_per_ro_subaru                  ,
parts_labor_sales_ratio              
from fact_metrics_agg_division_temp);

COMMIT;
